<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__i_r_timer_8hpp_source" xml:lang="en-US">
<title>IRTimer.hpp</title>
<indexterm><primary>main/IRRemote_Library/private/IRTimer.hpp</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="__i_r_timer_8hpp_source_1l00001"/>00001 
<anchor xml:id="__i_r_timer_8hpp_source_1l00032"/>00032 <emphasis role="preprocessor">#ifndef&#32;IR_TIMER_HPP</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00033"/>00033 <emphasis role="preprocessor">#define&#32;IR_TIMER_HPP</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00034"/>00034 
<anchor xml:id="__i_r_timer_8hpp_source_1l00035"/>00035 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__i_rremote_int_8h">IRremoteInt.h</link>&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00042"/>00042 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;!defined(ESP32)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00043"/>00043 <emphasis role="preprocessor">#undef&#32;IR_SEND_PIN&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;is&#32;determined&#32;by&#32;timer&#32;except&#32;for&#32;ESP32</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00044"/>00044 <emphasis role="preprocessor">#warning&#32;Since&#32;SEND_PWM_BY_TIMER&#32;is&#32;defined,&#32;the&#32;existing&#32;value&#32;of&#32;IR_SEND_PIN&#32;is&#32;discarded&#32;and&#32;replaced&#32;by&#32;the&#32;value&#32;determined&#32;by&#32;timer&#32;used&#32;for&#32;PWM&#32;generation</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00045"/>00045 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00046"/>00046 
<anchor xml:id="__i_r_timer_8hpp_source_1l00047"/>00047 <emphasis role="preprocessor">#if&#32;defined&#32;(DOXYGEN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00051"/>00051 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00052"/>00052 
<anchor xml:id="__i_r_timer_8hpp_source_1l00053"/>00053 <emphasis role="preprocessor">#elif&#32;defined(__AVR__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00054"/>00054 
<anchor xml:id="__i_r_timer_8hpp_source_1l00059"/>00059 
<anchor xml:id="__i_r_timer_8hpp_source_1l00062"/>00062 <emphasis role="comment">//&#32;Arduino&#32;Duemilanove,&#32;Diecimila,&#32;LilyPad,&#32;Mini,&#32;Fio,&#32;Nano,&#32;etc</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00063"/>00063 <emphasis role="comment">//&#32;ATmega328&#32;and&#32;ATmega88</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00064"/>00064 <emphasis role="preprocessor">#if&#32;defined(__AVR_ATmega328P__)&#32;||&#32;defined(__AVR_ATmega328PB__)&#32;||&#32;defined(__AVR_ATmega168__)&#32;||&#32;defined(__AVR_ATmega88P__)&#32;||&#32;defined(__AVR_ATmega88PB__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00065"/>00065 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER2)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00066"/>00066 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;9</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00067"/>00067 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER2&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;3</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00068"/>00068 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00069"/>00069 
<anchor xml:id="__i_r_timer_8hpp_source_1l00070"/>00070 <emphasis role="comment">//&#32;Arduino&#32;Mega</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00071"/>00071 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega1280__)&#32;||&#32;defined(__AVR_ATmega2560__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00072"/>00072 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER2)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER4)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER5)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00073"/>00073 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;11</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00074"/>00074 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER2&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;9</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00075"/>00075 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00076"/>00076 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER4&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;6</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00077"/>00077 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER5&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;46</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00078"/>00078 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00079"/>00079 
<anchor xml:id="__i_r_timer_8hpp_source_1l00080"/>00080 <emphasis role="comment">//&#32;Leonardo</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00081"/>00081 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega32U4__)&#32;&amp;&amp;&#32;!&#32;defined(TEENSYDUINO)&#32;&amp;&amp;&#32;!&#32;defined(ARDUINO_AVR_PROMICRO)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00082"/>00082 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER4_HS)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00083"/>00083 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;9</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00084"/>00084 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00085"/>00085 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER4_HS&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00086"/>00086 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00087"/>00087 
<anchor xml:id="__i_r_timer_8hpp_source_1l00088"/>00088 <emphasis role="comment">//&#32;Nano&#32;Every,&#32;Uno&#32;WiFi&#32;Rev2&#32;and&#32;similar</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00089"/>00089 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega808__)&#32;||&#32;defined(__AVR_ATmega809__)&#32;||&#32;defined(__AVR_ATmega3208__)&#32;||&#32;defined(__AVR_ATmega3209__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00090"/>00090 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;||&#32;defined(__AVR_ATmega1608__)&#32;||&#32;defined(__AVR_ATmega1609__)&#32;||&#32;defined(__AVR_ATmega4808__)&#32;||&#32;defined(__AVR_ATmega4809__)&#32;||&#32;defined(__AVR_ATtiny1604__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00091"/>00091 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER_B)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00092"/>00092 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER_B&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;&#32;send&#32;pin&#32;=&#32;pin&#32;6&#32;on&#32;ATmega4809&#32;1&#32;on&#32;ATmega4809</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00093"/>00093 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00094"/>00094 
<anchor xml:id="__i_r_timer_8hpp_source_1l00095"/>00095 <emphasis role="comment">//&#32;ATmega8u2,&#32;ATmega16U2,&#32;ATmega32U2</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00096"/>00096 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega8U2__)&#32;||&#32;defined(__AVR_ATmega16U2__)&#32;&#32;||&#32;defined(__AVR_ATmega32U2__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00097"/>00097 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00098"/>00098 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;C6</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00099"/>00099 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00100"/>00100 
<anchor xml:id="__i_r_timer_8hpp_source_1l00101"/>00101 <emphasis role="comment">//&#32;Atmega8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00102"/>00102 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega8__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00103"/>00103 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00104"/>00104 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;9</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00105"/>00105 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00106"/>00106 
<anchor xml:id="__i_r_timer_8hpp_source_1l00107"/>00107 <emphasis role="comment">//&#32;ATtiny84</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00108"/>00108 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATtiny84__)&#32;||&#32;defined(__AVR_ATtiny88__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00109"/>00109 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00110"/>00110 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;6</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00111"/>00111 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00112"/>00112 
<anchor xml:id="__i_r_timer_8hpp_source_1l00113"/>00113 <emphasis role="preprocessor">#elif&#32;&#32;defined(__AVR_ATtiny87__)&#32;||&#32;defined(__AVR_ATtiny167__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00114"/>00114 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00115"/>00115 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;PB1&#32;/&#32;8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00116"/>00116 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00117"/>00117 <emphasis role="preprocessor">#define&#32;USE_TIMER_CHANNEL_B</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00118"/>00118 
<anchor xml:id="__i_r_timer_8hpp_source_1l00119"/>00119 <emphasis role="comment">//ATtiny85</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00120"/>00120 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATtiny85__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00121"/>00121 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER_TINY0)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER_TINY1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00122"/>00122 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(ARDUINO_AVR_DIGISPARK)&#32;</emphasis><emphasis role="comment">//&#32;tested&#32;with&#32;16&#32;and&#32;8&#32;MHz</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00123"/>00123 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER_TINY0&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00124"/>00124 <emphasis role="comment">//&#32;standard&#32;Digispark&#32;settings&#32;use&#32;timer&#32;1&#32;for&#32;millis()&#32;and&#32;micros()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00125"/>00125 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00126"/>00126 <emphasis role="comment">//&#32;standard&#32;ATTinyCore&#32;settings&#32;use&#32;timer&#32;0&#32;for&#32;millis()&#32;and&#32;micros()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00127"/>00127 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER_TINY1&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;4</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00128"/>00128 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00129"/>00129 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00130"/>00130 
<anchor xml:id="__i_r_timer_8hpp_source_1l00131"/>00131 
<anchor xml:id="__i_r_timer_8hpp_source_1l00134"/>00134 <emphasis role="preprocessor">#elif&#32;defined(ARDUINO_AVR_PROMICRO)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00135"/>00135 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER4_HS)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00136"/>00136 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;9</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00137"/>00137 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00138"/>00138 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER4_HS&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00139"/>00139 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00140"/>00140 
<anchor xml:id="__i_r_timer_8hpp_source_1l00141"/>00141 
<anchor xml:id="__i_r_timer_8hpp_source_1l00144"/>00144 <emphasis role="comment">//&#32;Teensy&#32;1.0</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00145"/>00145 <emphasis role="preprocessor">#elif&#32;defined(__AVR_AT90USB162__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00146"/>00146 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00147"/>00147 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;17</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00148"/>00148 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00149"/>00149 
<anchor xml:id="__i_r_timer_8hpp_source_1l00150"/>00150 <emphasis role="comment">//&#32;Teensy++&#32;1.0&#32;&amp;&#32;2.0</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00151"/>00151 <emphasis role="preprocessor">#elif&#32;defined(__AVR_AT90USB646__)&#32;||&#32;defined(__AVR_AT90USB1286__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00152"/>00152 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER2)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00153"/>00153 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;25</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00154"/>00154 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER2&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00155"/>00155 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;16</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00156"/>00156 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00157"/>00157 
<anchor xml:id="__i_r_timer_8hpp_source_1l00158"/>00158 <emphasis role="comment">//&#32;Teensy&#32;2.0</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00159"/>00159 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega32U4__)&#32;&amp;&amp;&#32;defined(TEENSYDUINO)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00160"/>00160 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER4_HS)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00161"/>00161 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;14&#32;(Teensy&#32;2.0&#32;-&#32;physical&#32;pin:&#32;B5)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00162"/>00162 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;9&#32;&#32;(Teensy&#32;2.0&#32;-&#32;physical&#32;pin:&#32;C6)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00163"/>00163 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER4_HS&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;10&#32;(Teensy&#32;2.0&#32;-&#32;physical&#32;pin:&#32;C7)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00164"/>00164 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00165"/>00165 
<anchor xml:id="__i_r_timer_8hpp_source_1l00166"/>00166 
<anchor xml:id="__i_r_timer_8hpp_source_1l00169"/>00169 <emphasis role="comment">//&#32;MegaCore&#32;-&#32;ATmega64,&#32;ATmega128</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00170"/>00170 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega64__)&#32;||&#32;defined(__AVR_ATmega128__)&#32;||&#32;defined(__AVR_ATmega1281__)&#32;||&#32;defined(__AVR_ATmega2560__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00171"/>00171 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00172"/>00172 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00173"/>00173 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00174"/>00174 
<anchor xml:id="__i_r_timer_8hpp_source_1l00175"/>00175 
<anchor xml:id="__i_r_timer_8hpp_source_1l00178"/>00178 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega8515__)&#32;||&#32;defined(__AVR_ATmega162__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00179"/>00179 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00180"/>00180 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00181"/>00181 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;12&#32;-&#32;ATmega162&#32;only</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00182"/>00182 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00183"/>00183 
<anchor xml:id="__i_r_timer_8hpp_source_1l00184"/>00184 
<anchor xml:id="__i_r_timer_8hpp_source_1l00187"/>00187 <emphasis role="comment">//&#32;MightyCore&#32;-&#32;ATmega1284</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00188"/>00188 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega1284__)&#32;||&#32;defined(__AVR_ATmega1284P__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00189"/>00189 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER2)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER3)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00190"/>00190 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00191"/>00191 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER2&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;14</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00192"/>00192 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER3&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;6</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00193"/>00193 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00194"/>00194 
<anchor xml:id="__i_r_timer_8hpp_source_1l00195"/>00195 <emphasis role="comment">//&#32;MightyCore&#32;-&#32;ATmega164,&#32;ATmega324,&#32;ATmega644</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00196"/>00196 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega644__)&#32;||&#32;defined(__AVR_ATmega644P__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00197"/>00197 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega324P__)&#32;||&#32;defined(__AVR_ATmega324A__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00198"/>00198 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega324PA__)&#32;||&#32;defined(__AVR_ATmega164A__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00199"/>00199 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega164P__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00200"/>00200 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)&#32;&amp;&amp;&#32;!defined(IR_USE_AVR_TIMER2)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00201"/>00201 <emphasis role="comment">//#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00202"/>00202 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER2&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;14</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00203"/>00203 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00204"/>00204 
<anchor xml:id="__i_r_timer_8hpp_source_1l00205"/>00205 <emphasis role="comment">//&#32;MightyCore&#32;-&#32;ATmega8535,&#32;ATmega16,&#32;ATmega32</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00206"/>00206 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATmega8535__)&#32;||&#32;defined(__AVR_ATmega16__)&#32;||&#32;defined(__AVR_ATmega32__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00207"/>00207 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00208"/>00208 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER1&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;send&#32;pin&#32;=&#32;pin&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00209"/>00209 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00210"/>00210 
<anchor xml:id="__i_r_timer_8hpp_source_1l00211"/>00211 
<anchor xml:id="__i_r_timer_8hpp_source_1l00214"/>00214 <emphasis role="preprocessor">#elif&#32;defined(__AVR_ATtiny1616__)&#32;&#32;||&#32;defined(__AVR_ATtiny3216__)&#32;||&#32;defined(__AVR_ATtiny3217__)&#32;</emphasis><emphasis role="comment">//&#32;TinyCore&#32;boards</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00215"/>00215 <emphasis role="preprocessor">#define&#32;IR_USE_AVR_TIMER_D</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00216"/>00216 
<anchor xml:id="__i_r_timer_8hpp_source_1l00217"/>00217 <emphasis role="preprocessor">#endif&#32;</emphasis><emphasis role="comment">//&#32;AVR&#32;CPU&apos;s</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00218"/>00218 
<anchor xml:id="__i_r_timer_8hpp_source_1l00221"/>00221 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00222"/>00222 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer1&#32;(16&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00223"/>00223 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00224"/>00224 <emphasis role="preprocessor">#if&#32;defined(IR_USE_AVR_TIMER1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00225"/>00225 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00226"/>00226 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(CORE_OC1A_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00227"/>00227 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;CORE_OC1A_PIN&#32;&#32;</emphasis><emphasis role="comment">//&#32;Teensy</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00228"/>00228 
<anchor xml:id="__i_r_timer_8hpp_source_1l00229"/>00229 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1280__)&#32;||&#32;defined(__AVR_ATmega2560__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00230"/>00230 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;11&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Mega</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00231"/>00231 
<anchor xml:id="__i_r_timer_8hpp_source_1l00232"/>00232 <emphasis role="comment">//&#32;MightyCore,&#32;MegaCore,&#32;MajorCore</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00233"/>00233 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1284__)&#32;||&#32;defined(__AVR_ATmega1284P__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00234"/>00234 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega644__)&#32;||&#32;defined(__AVR_ATmega644P__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00235"/>00235 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega324P__)&#32;||&#32;defined(__AVR_ATmega324A__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00236"/>00236 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega324PA__)&#32;||&#32;defined(__AVR_ATmega164A__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00237"/>00237 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega164P__)&#32;||&#32;defined(__AVR_ATmega32__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00238"/>00238 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega16__)&#32;||&#32;defined(__AVR_ATmega8535__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00239"/>00239 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega64__)&#32;||&#32;defined(__AVR_ATmega128__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00240"/>00240 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega1281__)&#32;||&#32;defined(__AVR_ATmega2561__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00241"/>00241 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega8515__)&#32;||&#32;defined(__AVR_ATmega162__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00242"/>00242 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00243"/>00243 
<anchor xml:id="__i_r_timer_8hpp_source_1l00244"/>00244 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATtiny84__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00245"/>00245 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;6</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00246"/>00246 
<anchor xml:id="__i_r_timer_8hpp_source_1l00247"/>00247 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATtiny88__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00248"/>00248 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00249"/>00249 
<anchor xml:id="__i_r_timer_8hpp_source_1l00250"/>00250 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATtiny87__)&#32;||&#32;defined(__AVR_ATtiny167__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00251"/>00251 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;PIN_PB1&#32;</emphasis><emphasis role="comment">//&#32;OC1BU&#32;/&#32;PB1&#32;/&#32;Pin8&#32;at&#32;ATTinyCore&#32;(BU/PB1,&#32;BV/PB3,&#32;BW/PB5&#32;and&#32;BX/PB7&#32;are&#32;available)&#32;see&#32;ENABLE_SEND_PWM_BY_TIMER</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00252"/>00252 
<anchor xml:id="__i_r_timer_8hpp_source_1l00253"/>00253 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00254"/>00254 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;9&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;OC1A&#32;Arduino&#32;Duemilanove,&#32;Diecimila,&#32;LilyPad,&#32;Sparkfun&#32;Pro&#32;Micro,&#32;Leonardo,&#32;MH-ET&#32;Tiny88&#32;etc.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00255"/>00255 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif&#32;</emphasis><emphasis role="comment">//&#32;defined(CORE_OC1A_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00256"/>00256 
<anchor xml:id="__i_r_timer_8hpp_source_1l00257"/>00257 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(__AVR_ATtiny87__)&#32;||&#32;defined(__AVR_ATtiny167__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00258"/>00258 <emphasis role="comment">//&#32;Clear&#32;OC1A/OC1B&#32;on&#32;Compare&#32;Match&#32;when&#32;up-counting.&#32;Set&#32;OC1A/OC1B&#32;on&#32;Compare&#32;Match&#32;when&#32;downcounting.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00259"/>00259 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;TCNT1&#32;=&#32;0;&#32;&#32;(TCCR1A&#32;|=&#32;_BV(COM1A1);&#32;(TCCR1D&#32;|=&#32;_BV(OC1BU))&#32;</emphasis><emphasis role="comment">//&#32;+&#32;enable&#32;OC1BU&#32;as&#32;output</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00260"/>00260 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;(TCCR1D&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00261"/>00261 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00262"/>00262 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;TCNT1&#32;=&#32;0;&#32;(TCCR1A&#32;|=&#32;_BV(COM1A1))&#32;&#32;</emphasis><emphasis role="comment">//&#32;Clear&#32;OC1A/OC1B&#32;on&#32;Compare&#32;Match&#32;when&#32;up-counting.&#32;Set&#32;OC1A/OC1B&#32;on&#32;Compare&#32;Match&#32;when&#32;downcounting.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00263"/>00263 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;(TCCR1A&#32;&amp;=&#32;~(_BV(COM1A1)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00264"/>00264 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00265"/>00265 <emphasis role="preprocessor">#&#32;&#32;endif&#32;</emphasis><emphasis role="comment">//&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00266"/>00266 
<anchor xml:id="__i_r_timer_8hpp_source_1l00267"/>00267 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00268"/>00268 
<anchor xml:id="__i_r_timer_8hpp_source_1l00269"/>00269 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(__AVR_ATmega8__)&#32;||&#32;defined(__AVR_ATmega8515__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00270"/>00270 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega8535__)&#32;||&#32;defined(__AVR_ATmega16__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00271"/>00271 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega32__)&#32;||&#32;defined(__AVR_ATmega64__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00272"/>00272 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega128__)&#32;||&#32;defined(__AVR_ATmega162__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00273"/>00273 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK&#32;|=&#32;_BV(OCIE1A))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00274"/>00274 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK&#32;&amp;=&#32;~_BV(OCIE1A))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00275"/>00275 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00276"/>00276 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK1&#32;=&#32;_BV(OCIE1A))&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Timer/Counter1,&#32;Output&#32;Compare&#32;A&#32;Match&#32;Interrupt&#32;Enable</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00277"/>00277 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK1&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00278"/>00278 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00279"/>00279 
<anchor xml:id="__i_r_timer_8hpp_source_1l00280"/>00280 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(USE_TIMER_CHANNEL_B)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00281"/>00281 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(TIMER1_COMPB_vect)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00282"/>00282 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER1_COMPB_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00283"/>00283 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(TIM1_COMPB_vect)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00284"/>00284 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIM1_COMPB_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00285"/>00285 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00286"/>00286 <emphasis role="preprocessor">#else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00287"/>00287 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(TIMER1_COMPA_vect)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00288"/>00288 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER1_COMPA_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00289"/>00289 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(TIM1_COMPA_vect)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00290"/>00290 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIM1_COMPA_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00291"/>00291 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00292"/>00292 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00293"/>00293 
<anchor xml:id="__i_r_timer_8hpp_source_1l00294"/>00294 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00295"/>00295 <emphasis role="preprocessor">#&#32;&#32;if&#32;(((F_CPU&#32;/&#32;2000)&#32;/&#32;38)&#32;&lt;&#32;256)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00296"/>00296 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00297"/>00297 &#32;&#32;&#32;&#32;TCCR1A&#32;=&#32;_BV(WGM11);<emphasis role="comment">//&#32;PWM,&#32;Phase&#32;Correct,&#32;Top&#32;is&#32;ICR1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00298"/>00298 &#32;&#32;&#32;&#32;TCCR1B&#32;=&#32;_BV(WGM13)&#32;|&#32;_BV(CS10);<emphasis role="comment">//&#32;CS10&#32;-&gt;&#32;no&#32;prescaling</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00299"/>00299 &#32;&#32;&#32;&#32;ICR1&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00300"/>00300 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(USE_TIMER_CHANNEL_B)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00301"/>00301 &#32;&#32;&#32;&#32;OCR1A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00302"/>00302 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00303"/>00303 &#32;&#32;&#32;&#32;OCR1A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00304"/>00304 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00305"/>00305 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00306"/>00306 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00307"/>00307 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;((F_CPU&#32;/&#32;8)&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00308"/>00308 &#32;&#32;&#32;&#32;TCCR1A&#32;=&#32;_BV(WGM11);<emphasis role="comment">//&#32;PWM,&#32;Phase&#32;Correct,&#32;Top&#32;is&#32;ICR1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00309"/>00309 &#32;&#32;&#32;&#32;TCCR1B&#32;=&#32;_BV(WGM13)&#32;|&#32;_BV(CS11);<emphasis role="comment">//&#32;CS11&#32;-&gt;&#32;Prescaling&#32;by&#32;8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00310"/>00310 &#32;&#32;&#32;&#32;ICR1&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00311"/>00311 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(USE_TIMER_CHANNEL_B)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00312"/>00312 &#32;&#32;&#32;&#32;OCR1A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00313"/>00313 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00314"/>00314 &#32;&#32;&#32;&#32;OCR1A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00315"/>00315 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00316"/>00316 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00317"/>00317 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00318"/>00318 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00319"/>00319 
<anchor xml:id="__i_r_timer_8hpp_source_1l00320"/>00320 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00321"/>00321 &#32;&#32;&#32;&#32;TCCR1A&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00322"/>00322 &#32;&#32;&#32;&#32;TCCR1B&#32;=&#32;_BV(WGM12)&#32;|&#32;_BV(CS10);
<anchor xml:id="__i_r_timer_8hpp_source_1l00323"/>00323 &#32;&#32;&#32;&#32;OCR1A&#32;=&#32;F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>;
<anchor xml:id="__i_r_timer_8hpp_source_1l00324"/>00324 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00325"/>00325 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00326"/>00326 
<anchor xml:id="__i_r_timer_8hpp_source_1l00327"/>00327 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00328"/>00328 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer2&#32;(8&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00329"/>00329 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00330"/>00330 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER2)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00331"/>00331 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00332"/>00332 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(CORE_OC2B_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00333"/>00333 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;CORE_OC2B_PIN&#32;&#32;</emphasis><emphasis role="comment">//&#32;Teensy</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00334"/>00334 
<anchor xml:id="__i_r_timer_8hpp_source_1l00335"/>00335 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1280__)&#32;||&#32;defined(__AVR_ATmega2560__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00336"/>00336 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;9&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Mega</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00337"/>00337 
<anchor xml:id="__i_r_timer_8hpp_source_1l00338"/>00338 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1284__)&#32;||&#32;defined(__AVR_ATmega1284P__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00339"/>00339 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega644__)&#32;||&#32;defined(__AVR_ATmega644P__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00340"/>00340 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega324P__)&#32;||&#32;defined(__AVR_ATmega324A__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00341"/>00341 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega324PA__)&#32;||&#32;defined(__AVR_ATmega164A__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00342"/>00342 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega164P__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00343"/>00343 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;14&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;MightyCore,&#32;MegaCore</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00344"/>00344 
<anchor xml:id="__i_r_timer_8hpp_source_1l00345"/>00345 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00346"/>00346 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;3&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Duemilanove,&#32;Diecimila,&#32;LilyPad,&#32;etc</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00347"/>00347 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif&#32;</emphasis><emphasis role="comment">//&#32;defined(CORE_OC2B_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00348"/>00348 
<anchor xml:id="__i_r_timer_8hpp_source_1l00349"/>00349 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT2&#32;=&#32;0;&#32;(TCCR2A&#32;|=&#32;_BV(COM2B1))&#32;&#32;</emphasis><emphasis role="comment">//&#32;Clear&#32;OC2B&#32;on&#32;Compare&#32;Match</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00350"/>00350 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCCR2A&#32;&amp;=&#32;~(_BV(COM2B1)))&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Normal&#32;port&#32;operation,&#32;OC2B&#32;disconnected.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00351"/>00351 <emphasis role="preprocessor">#&#32;&#32;endif&#32;</emphasis><emphasis role="comment">//&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00352"/>00352 
<anchor xml:id="__i_r_timer_8hpp_source_1l00353"/>00353 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00354"/>00354 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK2&#32;=&#32;_BV(OCIE2B))&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Output&#32;Compare&#32;Match&#32;A&#32;Interrupt&#32;Enable</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00355"/>00355 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK2&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00356"/>00356 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER2_COMPB_vect&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;We&#32;use&#32;TIMER2_COMPB_vect&#32;to&#32;be&#32;compatible&#32;with&#32;tone()&#32;library</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00357"/>00357 
<anchor xml:id="__i_r_timer_8hpp_source_1l00358"/>00358 <emphasis role="comment">//&#32;The&#32;top&#32;value&#32;for&#32;the&#32;timer.&#32;&#32;The&#32;modulation&#32;frequency&#32;will&#32;be&#32;F_CPU&#32;/&#32;2&#32;/&#32;OCR2A.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00359"/>00359 <emphasis role="preprocessor">#pragma&#32;GCC&#32;diagnostic&#32;ignored&#32;&quot;-Wunused-function&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00360"/>00360 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00361"/>00361 <emphasis role="comment">&#32;*&#32;timerConfigForSend()&#32;is&#32;used&#32;exclusively&#32;by&#32;IRsend::enableIROut()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00362"/>00362 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00363"/>00363 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00364"/>00364 <emphasis role="preprocessor">#&#32;&#32;if&#32;(((F_CPU&#32;/&#32;2000)&#32;/&#32;38)&#32;&lt;&#32;256)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00365"/>00365 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00366"/>00366 &#32;&#32;&#32;&#32;TCCR2A&#32;=&#32;_BV(WGM20);<emphasis role="comment">//&#32;PWM,&#32;Phase&#32;Correct,&#32;Top&#32;is&#32;OCR2A</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00367"/>00367 &#32;&#32;&#32;&#32;TCCR2B&#32;=&#32;_BV(WGM22)&#32;|&#32;_BV(CS20);<emphasis role="comment">//&#32;CS20&#32;-&gt;&#32;no&#32;prescaling</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00368"/>00368 &#32;&#32;&#32;&#32;OCR2A&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00369"/>00369 &#32;&#32;&#32;&#32;OCR2B&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00370"/>00370 &#32;&#32;&#32;&#32;TCNT2&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00371"/>00371 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00372"/>00372 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;((F_CPU&#32;/&#32;8)&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00373"/>00373 &#32;&#32;&#32;&#32;TCCR2A&#32;=&#32;_BV(WGM20);<emphasis role="comment">//&#32;PWM,&#32;Phase&#32;Correct,&#32;Top&#32;is&#32;OCR2A</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00374"/>00374 &#32;&#32;&#32;&#32;TCCR2B&#32;=&#32;_BV(WGM22)&#32;|&#32;_BV(CS21);<emphasis role="comment">//&#32;CS21&#32;-&gt;&#32;Prescaling&#32;by&#32;8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00375"/>00375 &#32;&#32;&#32;&#32;OCR2A&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00376"/>00376 &#32;&#32;&#32;&#32;OCR2B&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00377"/>00377 &#32;&#32;&#32;&#32;TCNT2&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00378"/>00378 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00379"/>00379 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00380"/>00380 
<anchor xml:id="__i_r_timer_8hpp_source_1l00381"/>00381 <emphasis role="preprocessor">#define&#32;TIMER_COUNT_TOP&#32;&#32;(F_CPU&#32;*&#32;MICROS_PER_TICK&#32;/&#32;MICROS_IN_ONE_SECOND)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00382"/>00382 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00383"/>00383 <emphasis role="comment">&#32;*&#32;timerConfigForReceive()&#32;is&#32;used&#32;exclusively&#32;by&#32;IRrecv::enableIRIn()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00384"/>00384 <emphasis role="comment">&#32;*&#32;It&#32;generates&#32;an&#32;interrupt&#32;each&#32;50&#32;(MICROS_PER_TICK)&#32;us.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00385"/>00385 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00386"/>00386 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00387"/>00387 <emphasis role="preprocessor">#&#32;&#32;if&#32;(TIMER_COUNT_TOP&#32;&lt;&#32;256)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00388"/>00388 &#32;&#32;&#32;&#32;TCCR2A&#32;=&#32;_BV(WGM21);
<anchor xml:id="__i_r_timer_8hpp_source_1l00389"/>00389 &#32;&#32;&#32;&#32;TCCR2B&#32;=&#32;_BV(CS20);
<anchor xml:id="__i_r_timer_8hpp_source_1l00390"/>00390 &#32;&#32;&#32;&#32;OCR2A&#32;=&#32;TIMER_COUNT_TOP;
<anchor xml:id="__i_r_timer_8hpp_source_1l00391"/>00391 &#32;&#32;&#32;&#32;OCR2B&#32;=&#32;TIMER_COUNT_TOP;
<anchor xml:id="__i_r_timer_8hpp_source_1l00392"/>00392 &#32;&#32;&#32;&#32;TCNT2&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00393"/>00393 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00394"/>00394 &#32;&#32;&#32;&#32;TCCR2A&#32;=&#32;_BV(WGM21);
<anchor xml:id="__i_r_timer_8hpp_source_1l00395"/>00395 &#32;&#32;&#32;&#32;TCCR2B&#32;=&#32;_BV(CS21);
<anchor xml:id="__i_r_timer_8hpp_source_1l00396"/>00396 &#32;&#32;&#32;&#32;OCR2A&#32;=&#32;TIMER_COUNT_TOP&#32;/&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00397"/>00397 &#32;&#32;&#32;&#32;OCR2B&#32;=&#32;TIMER_COUNT_TOP&#32;/&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00398"/>00398 &#32;&#32;&#32;&#32;TCNT2&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00399"/>00399 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00400"/>00400 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00401"/>00401 
<anchor xml:id="__i_r_timer_8hpp_source_1l00402"/>00402 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00403"/>00403 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer3&#32;(16&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00404"/>00404 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00405"/>00405 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER3)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00406"/>00406 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00407"/>00407 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(CORE_OC3A_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00408"/>00408 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;CORE_OC3A_PIN&#32;&#32;</emphasis><emphasis role="comment">//&#32;Teensy</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00409"/>00409 
<anchor xml:id="__i_r_timer_8hpp_source_1l00410"/>00410 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1280__)&#32;||&#32;defined(__AVR_ATmega2560__)&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00411"/>00411 <emphasis role="preprocessor">||&#32;defined(__AVR_ATmega32U4__)&#32;||&#32;defined(ARDUINO_AVR_PROMICRO)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00412"/>00412 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;5&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Mega,&#32;Arduino&#32;Leonardo,&#32;Sparkfun&#32;Pro&#32;Micro</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00413"/>00413 
<anchor xml:id="__i_r_timer_8hpp_source_1l00414"/>00414 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1284__)&#32;||&#32;defined(__AVR_ATmega1284P__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00415"/>00415 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;6&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;MightyCore,&#32;MegaCore</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00416"/>00416 
<anchor xml:id="__i_r_timer_8hpp_source_1l00417"/>00417 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00418"/>00418 <emphasis role="preprocessor">#error&#32;Please&#32;add&#32;OC3A&#32;pin&#32;number&#32;here</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00419"/>00419 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00420"/>00420 
<anchor xml:id="__i_r_timer_8hpp_source_1l00421"/>00421 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT3&#32;=&#32;0;&#32;(TCCR3A&#32;|=&#32;_BV(COM3A1))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00422"/>00422 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCCR3A&#32;&amp;=&#32;~(_BV(COM3A1)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00423"/>00423 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00424"/>00424 
<anchor xml:id="__i_r_timer_8hpp_source_1l00425"/>00425 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00426"/>00426 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK3&#32;=&#32;_BV(OCIE3B))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00427"/>00427 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK3&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00428"/>00428 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER3_COMPB_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00429"/>00429 
<anchor xml:id="__i_r_timer_8hpp_source_1l00430"/>00430 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00431"/>00431 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;F_CPU&#32;&gt;&#32;16000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00432"/>00432 <emphasis role="preprocessor">#error&#32;&quot;Creating&#32;timer&#32;PWM&#32;with&#32;timer&#32;3&#32;is&#32;not&#32;supported&#32;for&#32;F_CPU&#32;&gt;&#32;16&#32;MHz&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00433"/>00433 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00434"/>00434 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00435"/>00435 &#32;&#32;&#32;&#32;TCCR3A&#32;=&#32;_BV(WGM31);
<anchor xml:id="__i_r_timer_8hpp_source_1l00436"/>00436 &#32;&#32;&#32;&#32;TCCR3B&#32;=&#32;_BV(WGM33)&#32;|&#32;_BV(CS30);<emphasis role="comment">//&#32;PWM,&#32;Phase&#32;Correct,&#32;ICRn&#32;as&#32;TOP,&#32;complete&#32;period&#32;is&#32;double&#32;of&#32;pwmval</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00437"/>00437 &#32;&#32;&#32;&#32;ICR3&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00438"/>00438 &#32;&#32;&#32;&#32;OCR3A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00439"/>00439 &#32;&#32;&#32;&#32;TCNT3&#32;=&#32;0;<emphasis role="comment">//&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;16&#32;bit&#32;counter</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00440"/>00440 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00441"/>00441 
<anchor xml:id="__i_r_timer_8hpp_source_1l00442"/>00442 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00443"/>00443 &#32;&#32;&#32;&#32;TCCR3A&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00444"/>00444 &#32;&#32;&#32;&#32;TCCR3B&#32;=&#32;_BV(WGM32)&#32;|&#32;_BV(CS30);
<anchor xml:id="__i_r_timer_8hpp_source_1l00445"/>00445 &#32;&#32;&#32;&#32;OCR3A&#32;=&#32;F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>;
<anchor xml:id="__i_r_timer_8hpp_source_1l00446"/>00446 &#32;&#32;&#32;&#32;OCR3B&#32;=&#32;F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>;
<anchor xml:id="__i_r_timer_8hpp_source_1l00447"/>00447 &#32;&#32;&#32;&#32;TCNT3&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00448"/>00448 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00449"/>00449 
<anchor xml:id="__i_r_timer_8hpp_source_1l00450"/>00450 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00451"/>00451 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer4&#32;(16&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00452"/>00452 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00453"/>00453 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER4)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00454"/>00454 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00455"/>00455 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(CORE_OC4A_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00456"/>00456 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;CORE_OC4A_PIN</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00457"/>00457 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1280__)&#32;||&#32;defined(__AVR_ATmega2560__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00458"/>00458 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;6&#32;&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Mega</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00459"/>00459 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00460"/>00460 <emphasis role="preprocessor">#error&#32;Please&#32;add&#32;OC4A&#32;pin&#32;number&#32;here</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00461"/>00461 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00462"/>00462 
<anchor xml:id="__i_r_timer_8hpp_source_1l00463"/>00463 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;&#32;(TCCR4A&#32;|=&#32;_BV(COM4A1))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00464"/>00464 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCCR4A&#32;&amp;=&#32;~(_BV(COM4A1)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00465"/>00465 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00466"/>00466 
<anchor xml:id="__i_r_timer_8hpp_source_1l00467"/>00467 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00468"/>00468 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK4&#32;=&#32;_BV(OCIE4A))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00469"/>00469 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK4&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00470"/>00470 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER4_COMPA_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00471"/>00471 
<anchor xml:id="__i_r_timer_8hpp_source_1l00472"/>00472 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00473"/>00473 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;F_CPU&#32;&gt;&#32;16000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00474"/>00474 <emphasis role="preprocessor">#error&#32;&quot;Creating&#32;timer&#32;PWM&#32;with&#32;timer&#32;4&#32;is&#32;not&#32;supported&#32;for&#32;F_CPU&#32;&gt;&#32;16&#32;MHz&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00475"/>00475 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00476"/>00476 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00477"/>00477 &#32;&#32;&#32;&#32;TCCR4A&#32;=&#32;_BV(WGM41);
<anchor xml:id="__i_r_timer_8hpp_source_1l00478"/>00478 &#32;&#32;&#32;&#32;TCCR4B&#32;=&#32;_BV(WGM43)&#32;|&#32;_BV(CS40);
<anchor xml:id="__i_r_timer_8hpp_source_1l00479"/>00479 &#32;&#32;&#32;&#32;ICR4&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00480"/>00480 &#32;&#32;&#32;&#32;OCR4A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00481"/>00481 &#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;<emphasis role="comment">//&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;16&#32;bit&#32;counter</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00482"/>00482 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00483"/>00483 
<anchor xml:id="__i_r_timer_8hpp_source_1l00484"/>00484 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00485"/>00485 &#32;&#32;&#32;&#32;TCCR4A&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00486"/>00486 &#32;&#32;&#32;&#32;TCCR4B&#32;=&#32;_BV(WGM42)&#32;|&#32;_BV(CS40);
<anchor xml:id="__i_r_timer_8hpp_source_1l00487"/>00487 &#32;&#32;&#32;&#32;OCR4A&#32;=&#32;F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>;
<anchor xml:id="__i_r_timer_8hpp_source_1l00488"/>00488 &#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00489"/>00489 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00490"/>00490 
<anchor xml:id="__i_r_timer_8hpp_source_1l00491"/>00491 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00492"/>00492 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer4&#32;(10&#32;bits,&#32;high&#32;speed&#32;option)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00493"/>00493 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00494"/>00494 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER4_HS)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00495"/>00495 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00496"/>00496 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(CORE_OC4A_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00497"/>00497 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;CORE_OC4A_PIN&#32;&#32;</emphasis><emphasis role="comment">//&#32;Teensy&#32;2.0</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00498"/>00498 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(ARDUINO_AVR_PROMICRO)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00499"/>00499 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;5&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Sparkfun&#32;Pro&#32;Micro</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00500"/>00500 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega32U4__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00501"/>00501 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;13&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Leonardo</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00502"/>00502 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00503"/>00503 <emphasis role="preprocessor">#error&#32;Please&#32;add&#32;OC4A&#32;pin&#32;number&#32;here</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00504"/>00504 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00505"/>00505 
<anchor xml:id="__i_r_timer_8hpp_source_1l00506"/>00506 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(ARDUINO_AVR_PROMICRO)&#32;</emphasis><emphasis role="comment">//&#32;Sparkfun&#32;Pro&#32;Micro</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00507"/>00507 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;&#32;(TCCR4A&#32;|=&#32;_BV(COM4A0))&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;Use&#32;complementary&#32;OC4A&#32;output&#32;on&#32;pin&#32;5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00508"/>00508 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCCR4A&#32;&amp;=&#32;~(_BV(COM4A0)))&#32;&#32;</emphasis><emphasis role="comment">//&#32;(Pro&#32;Micro&#32;does&#32;not&#32;map&#32;PC7&#32;(32/ICP3/CLK0/OC4A)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00509"/>00509 <emphasis role="comment">//&#32;of&#32;ATmega32U4&#32;)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00510"/>00510 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00511"/>00511 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;&#32;(TCCR4A&#32;|=&#32;_BV(COM4A1));&#32;DDRC&#32;|=&#32;(1&lt;&lt;7)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00512"/>00512 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCCR4A&#32;&amp;=&#32;~(_BV(COM4A1)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00513"/>00513 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00514"/>00514 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00515"/>00515 
<anchor xml:id="__i_r_timer_8hpp_source_1l00516"/>00516 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00517"/>00517 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK4&#32;=&#32;_BV(TOIE4))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00518"/>00518 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK4&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00519"/>00519 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER4_OVF_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00520"/>00520 
<anchor xml:id="__i_r_timer_8hpp_source_1l00521"/>00521 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00522"/>00522 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;F_CPU&#32;&gt;&#32;16000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00523"/>00523 <emphasis role="preprocessor">#error&#32;&quot;Creating&#32;timer&#32;PWM&#32;with&#32;timer&#32;4&#32;HS&#32;is&#32;not&#32;supported&#32;for&#32;F_CPU&#32;&gt;&#32;16&#32;MHz&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00524"/>00524 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00525"/>00525 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;((F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz))&#32;-&#32;1;&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00526"/>00526 &#32;&#32;&#32;&#32;TCCR4A&#32;=&#32;(1&#32;&lt;&lt;&#32;PWM4A);
<anchor xml:id="__i_r_timer_8hpp_source_1l00527"/>00527 &#32;&#32;&#32;&#32;TCCR4B&#32;=&#32;_BV(CS40);
<anchor xml:id="__i_r_timer_8hpp_source_1l00528"/>00528 &#32;&#32;&#32;&#32;TCCR4C&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00529"/>00529 &#32;&#32;&#32;&#32;TCCR4D&#32;=&#32;(1&#32;&lt;&lt;&#32;WGM40);
<anchor xml:id="__i_r_timer_8hpp_source_1l00530"/>00530 &#32;&#32;&#32;&#32;TCCR4E&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00531"/>00531 &#32;&#32;&#32;&#32;TC4H&#32;=&#32;pwmval&#32;&gt;&gt;&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00532"/>00532 &#32;&#32;&#32;&#32;OCR4C&#32;=&#32;pwmval;
<anchor xml:id="__i_r_timer_8hpp_source_1l00533"/>00533 &#32;&#32;&#32;&#32;TC4H&#32;=&#32;(pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>&#32;/&#32;100)&#32;&gt;&gt;&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00534"/>00534 &#32;&#32;&#32;&#32;OCR4A&#32;=&#32;(pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>&#32;/&#32;100)&#32;&amp;&#32;255;
<anchor xml:id="__i_r_timer_8hpp_source_1l00535"/>00535 &#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00536"/>00536 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00537"/>00537 
<anchor xml:id="__i_r_timer_8hpp_source_1l00538"/>00538 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00539"/>00539 &#32;&#32;&#32;&#32;TCCR4A&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00540"/>00540 &#32;&#32;&#32;&#32;TCCR4B&#32;=&#32;_BV(CS40);
<anchor xml:id="__i_r_timer_8hpp_source_1l00541"/>00541 &#32;&#32;&#32;&#32;TCCR4C&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00542"/>00542 &#32;&#32;&#32;&#32;TCCR4D&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00543"/>00543 &#32;&#32;&#32;&#32;TCCR4E&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00544"/>00544 &#32;&#32;&#32;&#32;TC4H&#32;=&#32;(F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>)&#32;&gt;&gt;&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00545"/>00545 &#32;&#32;&#32;&#32;OCR4C&#32;=&#32;(F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>)&#32;&amp;&#32;255;
<anchor xml:id="__i_r_timer_8hpp_source_1l00546"/>00546 &#32;&#32;&#32;&#32;TC4H&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00547"/>00547 &#32;&#32;&#32;&#32;TCNT4&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00548"/>00548 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00549"/>00549 
<anchor xml:id="__i_r_timer_8hpp_source_1l00550"/>00550 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00551"/>00551 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer5&#32;(16&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00552"/>00552 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00553"/>00553 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER5)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00554"/>00554 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00555"/>00555 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(CORE_OC5A_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00556"/>00556 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;CORE_OC5A_PIN</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00557"/>00557 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;elif&#32;defined(__AVR_ATmega1280__)&#32;||&#32;defined(__AVR_ATmega2560__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00558"/>00558 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;46&#32;&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Mega</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00559"/>00559 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00560"/>00560 <emphasis role="preprocessor">#error&#32;Please&#32;add&#32;OC5A&#32;pin&#32;number&#32;here</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00561"/>00561 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00562"/>00562 
<anchor xml:id="__i_r_timer_8hpp_source_1l00563"/>00563 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT5&#32;=&#32;0;&#32;(TCCR5A&#32;|=&#32;_BV(COM5A1))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00564"/>00564 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCCR5A&#32;&amp;=&#32;~(_BV(COM5A1)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00565"/>00565 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00566"/>00566 
<anchor xml:id="__i_r_timer_8hpp_source_1l00567"/>00567 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00568"/>00568 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK5&#32;=&#32;_BV(OCIE5A))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00569"/>00569 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK5&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00570"/>00570 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER5_COMPA_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00571"/>00571 
<anchor xml:id="__i_r_timer_8hpp_source_1l00572"/>00572 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00573"/>00573 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;F_CPU&#32;&gt;&#32;16000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00574"/>00574 <emphasis role="preprocessor">#error&#32;&quot;Creating&#32;timer&#32;PWM&#32;with&#32;timer&#32;5&#32;is&#32;not&#32;supported&#32;for&#32;F_CPU&#32;&gt;&#32;16&#32;MHz&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00575"/>00575 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00576"/>00576 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00577"/>00577 &#32;&#32;&#32;&#32;TCCR5A&#32;=&#32;_BV(WGM51);
<anchor xml:id="__i_r_timer_8hpp_source_1l00578"/>00578 &#32;&#32;&#32;&#32;TCCR5B&#32;=&#32;_BV(WGM53)&#32;|&#32;_BV(CS50);
<anchor xml:id="__i_r_timer_8hpp_source_1l00579"/>00579 &#32;&#32;&#32;&#32;ICR5&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00580"/>00580 &#32;&#32;&#32;&#32;OCR5A&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00581"/>00581 &#32;&#32;&#32;&#32;TCNT5&#32;=&#32;0;<emphasis role="comment">//&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;16&#32;bit&#32;counter</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00582"/>00582 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00583"/>00583 
<anchor xml:id="__i_r_timer_8hpp_source_1l00584"/>00584 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00585"/>00585 &#32;&#32;&#32;&#32;TCCR5A&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00586"/>00586 &#32;&#32;&#32;&#32;TCCR5B&#32;=&#32;_BV(WGM52)&#32;|&#32;_BV(CS50);
<anchor xml:id="__i_r_timer_8hpp_source_1l00587"/>00587 &#32;&#32;&#32;&#32;OCR5A&#32;=&#32;F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>;
<anchor xml:id="__i_r_timer_8hpp_source_1l00588"/>00588 &#32;&#32;&#32;&#32;TCNT5&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00589"/>00589 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00590"/>00590 
<anchor xml:id="__i_r_timer_8hpp_source_1l00591"/>00591 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00592"/>00592 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer0&#32;for&#32;ATtinies&#32;(8&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00593"/>00593 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00594"/>00594 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER_TINY0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00595"/>00595 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00596"/>00596 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00597"/>00597 
<anchor xml:id="__i_r_timer_8hpp_source_1l00598"/>00598 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TCNT0&#32;=&#32;0;&#32;(TCCR0A&#32;|=&#32;_BV(COM0B1))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00599"/>00599 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;(TCCR0A&#32;&amp;=&#32;~(_BV(COM0B1)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00600"/>00600 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00601"/>00601 
<anchor xml:id="__i_r_timer_8hpp_source_1l00602"/>00602 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00603"/>00603 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;&#32;&#32;&#32;&#32;(TIMSK&#32;|=&#32;_BV(OCIE0A))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00604"/>00604 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;&#32;&#32;&#32;&#32;(TIMSK&#32;&amp;=&#32;~(_BV(OCIE0A)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00605"/>00605 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER0_COMPA_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00606"/>00606 
<anchor xml:id="__i_r_timer_8hpp_source_1l00607"/>00607 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00608"/>00608 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;F_CPU&#32;&gt;&#32;16000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00609"/>00609 <emphasis role="preprocessor">#error&#32;&quot;Creating&#32;timer&#32;PWM&#32;with&#32;timer&#32;TINY0&#32;is&#32;not&#32;supported&#32;for&#32;F_CPU&#32;&gt;&#32;16&#32;MHz&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00610"/>00610 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00611"/>00611 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;Phase&#32;Correct&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00612"/>00612 &#32;&#32;&#32;&#32;TCCR0A&#32;=&#32;_BV(WGM00);<emphasis role="comment">//&#32;PWM,&#32;Phase&#32;Correct,&#32;Top&#32;is&#32;OCR0A</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00613"/>00613 &#32;&#32;&#32;&#32;TCCR0B&#32;=&#32;_BV(WGM02)&#32;|&#32;_BV(CS00);<emphasis role="comment">//&#32;CS00&#32;-&gt;&#32;no&#32;prescaling</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00614"/>00614 &#32;&#32;&#32;&#32;OCR0A&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00615"/>00615 &#32;&#32;&#32;&#32;OCR0B&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00616"/>00616 &#32;&#32;&#32;&#32;TCNT0&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00617"/>00617 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00618"/>00618 
<anchor xml:id="__i_r_timer_8hpp_source_1l00619"/>00619 <emphasis role="preprocessor">#define&#32;TIMER_COUNT_TOP&#32;&#32;(F_CPU&#32;*&#32;MICROS_PER_TICK&#32;/&#32;MICROS_IN_ONE_SECOND)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00620"/>00620 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00621"/>00621 <emphasis role="preprocessor">#&#32;&#32;if&#32;(TIMER_COUNT_TOP&#32;&lt;&#32;256)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00622"/>00622 &#32;&#32;&#32;&#32;TCCR0A&#32;=&#32;_BV(WGM01);&#32;<emphasis role="comment">//&#32;CTC,&#32;Top&#32;is&#32;OCR0A</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00623"/>00623 &#32;&#32;&#32;&#32;TCCR0B&#32;=&#32;_BV(CS00);<emphasis role="comment">//&#32;No&#32;prescaling</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00624"/>00624 &#32;&#32;&#32;&#32;OCR0A&#32;=&#32;TIMER_COUNT_TOP;
<anchor xml:id="__i_r_timer_8hpp_source_1l00625"/>00625 &#32;&#32;&#32;&#32;TCNT0&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00626"/>00626 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00627"/>00627 &#32;&#32;&#32;&#32;TCCR0A&#32;=&#32;_BV(WGM01);
<anchor xml:id="__i_r_timer_8hpp_source_1l00628"/>00628 &#32;&#32;&#32;&#32;TCCR0B&#32;=&#32;_BV(CS01);&#32;<emphasis role="comment">//&#32;prescaling&#32;by&#32;8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00629"/>00629 &#32;&#32;&#32;&#32;OCR0A&#32;=&#32;TIMER_COUNT_TOP&#32;/&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00630"/>00630 &#32;&#32;&#32;&#32;TCNT0&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00631"/>00631 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00632"/>00632 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00633"/>00633 
<anchor xml:id="__i_r_timer_8hpp_source_1l00634"/>00634 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00635"/>00635 <emphasis role="comment">&#32;*&#32;AVR&#32;Timer1&#32;for&#32;ATtinies&#32;(8&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00636"/>00636 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00637"/>00637 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER_TINY1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00638"/>00638 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00639"/>00639 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;4</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00640"/>00640 
<anchor xml:id="__i_r_timer_8hpp_source_1l00641"/>00641 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;&#32;GTCCR&#32;|=&#32;_BV(PWM1B)&#32;|&#32;_BV(COM1B0)&#32;</emphasis><emphasis role="comment">//&#32;Enable&#32;pin&#32;4&#32;PWM&#32;output&#32;(PB4&#32;-&#32;Arduino&#32;D4)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00642"/>00642 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(GTCCR&#32;&amp;=&#32;~(_BV(PWM1B)&#32;|&#32;_BV(COM1B0)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00643"/>00643 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00644"/>00644 
<anchor xml:id="__i_r_timer_8hpp_source_1l00645"/>00645 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00646"/>00646 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TIMSK&#32;|=&#32;_BV(OCIE1B))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00647"/>00647 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TIMSK&#32;&amp;=&#32;~(_BV(OCIE1B)))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00648"/>00648 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TIMER1_COMPB_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00649"/>00649 
<anchor xml:id="__i_r_timer_8hpp_source_1l00650"/>00650 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00651"/>00651 <emphasis role="preprocessor">#&#32;&#32;if&#32;(((F_CPU&#32;/&#32;1000)&#32;/&#32;38)&#32;&lt;&#32;256)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00652"/>00652 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;1000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;421&#32;@16&#32;MHz,&#32;26&#32;@1&#32;MHz&#32;and&#32;38&#32;kHz</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00653"/>00653 &#32;&#32;&#32;&#32;TCCR1&#32;=&#32;_BV(CTC1)&#32;|&#32;_BV(CS10);<emphasis role="comment">//&#32;CTC1&#32;=&#32;1:&#32;TOP&#32;value&#32;set&#32;to&#32;OCR1C,&#32;CS10&#32;No&#32;Prescaling</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00654"/>00654 &#32;&#32;&#32;&#32;OCR1C&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00655"/>00655 &#32;&#32;&#32;&#32;OCR1B&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00656"/>00656 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00657"/>00657 &#32;&#32;&#32;&#32;GTCCR&#32;=&#32;_BV(PWM1B)&#32;|&#32;_BV(COM1B0);<emphasis role="comment">//&#32;PWM1B&#32;=&#32;1:&#32;Enable&#32;PWM&#32;for&#32;OCR1B,&#32;COM1B0&#32;Clear&#32;on&#32;compare&#32;match</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00658"/>00658 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00659"/>00659 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;((F_CPU&#32;/&#32;2)&#32;/&#32;1000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210&#32;for&#32;16&#32;MHz&#32;and&#32;38&#32;kHz</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00660"/>00660 &#32;&#32;&#32;&#32;TCCR1&#32;=&#32;_BV(CTC1)&#32;|&#32;_BV(CS11);<emphasis role="comment">//&#32;CTC1&#32;=&#32;1:&#32;TOP&#32;value&#32;set&#32;to&#32;OCR1C,&#32;CS11&#32;Prescaling&#32;by&#32;2</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00661"/>00661 &#32;&#32;&#32;&#32;OCR1C&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00662"/>00662 &#32;&#32;&#32;&#32;OCR1B&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00663"/>00663 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00664"/>00664 &#32;&#32;&#32;&#32;GTCCR&#32;=&#32;_BV(PWM1B)&#32;|&#32;_BV(COM1B0);<emphasis role="comment">//&#32;PWM1B&#32;=&#32;1:&#32;Enable&#32;PWM&#32;for&#32;OCR1B,&#32;COM1B0&#32;Clear&#32;on&#32;compare&#32;match</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00665"/>00665 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00666"/>00666 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00667"/>00667 
<anchor xml:id="__i_r_timer_8hpp_source_1l00668"/>00668 <emphasis role="preprocessor">#define&#32;TIMER_COUNT_TOP&#32;&#32;(F_CPU&#32;*&#32;MICROS_PER_TICK&#32;/&#32;MICROS_IN_ONE_SECOND)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00669"/>00669 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00670"/>00670 <emphasis role="preprocessor">#&#32;&#32;if&#32;(TIMER_COUNT_TOP&#32;&lt;&#32;256)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00671"/>00671 &#32;&#32;&#32;&#32;TCCR1&#32;=&#32;_BV(CTC1)&#32;|&#32;_BV(CS10);&#32;<emphasis role="comment">//&#32;Clear&#32;Timer/Counter&#32;on&#32;Compare&#32;Match,&#32;Top&#32;is&#32;OCR1C,&#32;No&#32;prescaling</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00672"/>00672 &#32;&#32;&#32;&#32;GTCCR&#32;=&#32;0;&#32;<emphasis role="comment">//&#32;normal,&#32;non-PWM&#32;mode</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00673"/>00673 &#32;&#32;&#32;&#32;OCR1C&#32;=&#32;TIMER_COUNT_TOP;
<anchor xml:id="__i_r_timer_8hpp_source_1l00674"/>00674 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00675"/>00675 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00676"/>00676 &#32;&#32;&#32;&#32;TCCR1&#32;=&#32;_BV(CTC1)&#32;|&#32;_BV(CS12);&#32;<emphasis role="comment">//&#32;Clear&#32;Timer/Counter&#32;on&#32;Compare&#32;Match,&#32;Top&#32;is&#32;OCR1C,&#32;prescaling&#32;by&#32;8</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00677"/>00677 &#32;&#32;&#32;&#32;GTCCR&#32;=&#32;0;&#32;<emphasis role="comment">//&#32;normal,&#32;non-PWM&#32;mode</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00678"/>00678 &#32;&#32;&#32;&#32;OCR1C&#32;=&#32;TIMER_COUNT_TOP&#32;/&#32;8;
<anchor xml:id="__i_r_timer_8hpp_source_1l00679"/>00679 &#32;&#32;&#32;&#32;TCNT1&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00680"/>00680 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00681"/>00681 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00682"/>00682 
<anchor xml:id="__i_r_timer_8hpp_source_1l00683"/>00683 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00684"/>00684 <emphasis role="comment">&#32;*&#32;AVR&#32;TimerB&#32;&#32;(8&#32;bits)&#32;for&#32;ATmega4809&#32;(Nano&#32;Every,&#32;Uno&#32;WiFi&#32;Rev2)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00685"/>00685 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00686"/>00686 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER_B)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00687"/>00687 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00688"/>00688 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(__AVR_ATmega4808__)&#32;||&#32;defined(__AVR_ATmega4809__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00689"/>00689 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;6&#32;</emphasis><emphasis role="comment">//&#32;PF4&#32;on&#32;ATmega4809&#32;/&#32;Nano&#32;Every&#32;(see&#32;pins_arduino.h&#32;digital_pin_to_timer)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00690"/>00690 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00691"/>00691 <emphasis role="preprocessor">#error&#32;SEND_PWM_BY_TIMER&#32;not&#32;yet&#32;supported&#32;for&#32;this&#32;CPU</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00692"/>00692 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00693"/>00693 
<anchor xml:id="__i_r_timer_8hpp_source_1l00694"/>00694 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;TCB0.CNT&#32;=&#32;0;&#32;(TCB0.CTRLB&#32;|=&#32;TCB_CCMPEN_bm)&#32;</emphasis><emphasis role="comment">//&#32;set&#32;Compare/Capture&#32;Output&#32;Enable</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00695"/>00695 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCB0.CTRLB&#32;&amp;=&#32;~(TCB_CCMPEN_bm))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00696"/>00696 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00697"/>00697 
<anchor xml:id="__i_r_timer_8hpp_source_1l00698"/>00698 <emphasis role="comment">//&#32;ATmega4809&#32;TCB0</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00699"/>00699 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING&#32;&#32;&#32;&#32;TCB0.INTFLAGS&#32;=&#32;TCB_CAPT_bm</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00700"/>00700 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TCB0.INTCTRL&#32;=&#32;TCB_CAPT_bm)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00701"/>00701 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TCB0.INTCTRL&#32;&amp;=&#32;~(TCB_CAPT_bm))</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00702"/>00702 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TCB0_INT_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00703"/>00703 
<anchor xml:id="__i_r_timer_8hpp_source_1l00704"/>00704 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00705"/>00705 <emphasis role="preprocessor">#if&#32;defined(SEND_PWM_BY_TIMER)&#32;&amp;&amp;&#32;F_CPU&#32;&gt;&#32;16000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00706"/>00706 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;we&#32;have&#32;only&#32;prescaler&#32;2&#32;or&#32;must&#32;take&#32;clock&#32;of&#32;timer&#32;A&#32;(which&#32;is&#32;non&#32;deterministic)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00707"/>00707 <emphasis role="preprocessor">#error&#32;&quot;Creating&#32;timer&#32;PWM&#32;with&#32;timer&#32;TCB0&#32;is&#32;not&#32;possible&#32;for&#32;F_CPU&#32;&gt;&#32;16&#32;MHz&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00708"/>00708 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00709"/>00709 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;2000)&#32;/&#32;(aFrequencyKHz);&#32;<emphasis role="comment">//&#32;210,52&#32;for&#32;38&#32;kHz&#32;@16&#32;MHz&#32;clock,&#32;2000&#32;instead&#32;of&#32;1000&#32;because&#32;of&#32;using&#32;CLK&#32;/&#32;2</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00710"/>00710 &#32;&#32;&#32;&#32;TCB0.CTRLB&#32;=&#32;TCB_CNTMODE_PWM8_gc;&#32;&#32;&#32;<emphasis role="comment">//&#32;8&#32;bit&#32;PWM&#32;mode</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00711"/>00711 &#32;&#32;&#32;&#32;TCB0.CCMPL&#32;=&#32;pwmval&#32;-&#32;1;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Period&#32;of&#32;8&#32;bit&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00712"/>00712 &#32;&#32;&#32;&#32;TCB0.CCMPH&#32;=&#32;((pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>)&#32;/&#32;100)&#32;-&#32;1;&#32;<emphasis role="comment">//&#32;Duty&#32;cycle&#32;of&#32;waveform&#32;of&#32;8&#32;bit&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00713"/>00713 &#32;&#32;&#32;&#32;TCB0.CTRLA&#32;=&#32;(TCB_CLKSEL_CLKDIV2_gc)&#32;|&#32;(TCB_ENABLE_bm);&#32;<emphasis role="comment">//&#32;use&#32;CLK&#32;/&#32;2</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00714"/>00714 &#32;&#32;&#32;&#32;TCB0.CNT&#32;=&#32;0;&#32;<emphasis role="comment">//&#32;not&#32;really&#32;required,&#32;since&#32;we&#32;have&#32;an&#32;8&#32;bit&#32;counter,&#32;but&#32;makes&#32;the&#32;signal&#32;more&#32;reproducible</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00715"/>00715 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00716"/>00716 
<anchor xml:id="__i_r_timer_8hpp_source_1l00717"/>00717 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00718"/>00718 &#32;&#32;&#32;&#32;TCB0.CTRLB&#32;=&#32;(TCB_CNTMODE_INT_gc);&#32;&#32;<emphasis role="comment">//&#32;Periodic&#32;interrupt&#32;mode</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00719"/>00719 &#32;&#32;&#32;&#32;TCB0.CCMP&#32;=&#32;((F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>)&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>);
<anchor xml:id="__i_r_timer_8hpp_source_1l00720"/>00720 &#32;&#32;&#32;&#32;TCB0.INTFLAGS&#32;=&#32;TCB_CAPT_bm;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;reset&#32;interrupt&#32;flags</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00721"/>00721 &#32;&#32;&#32;&#32;TCB0.CTRLA&#32;=&#32;(TCB_CLKSEL_CLKDIV1_gc)&#32;|&#32;(TCB_ENABLE_bm);
<anchor xml:id="__i_r_timer_8hpp_source_1l00722"/>00722 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00723"/>00723 
<anchor xml:id="__i_r_timer_8hpp_source_1l00724"/>00724 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00725"/>00725 <emphasis role="comment">&#32;*&#32;AVR&#32;TimerD&#32;for&#32;TinyCore&#32;32&#32;(16&#32;bits)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00726"/>00726 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00727"/>00727 <emphasis role="preprocessor">#elif&#32;defined(IR_USE_AVR_TIMER_D)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00728"/>00728 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00729"/>00729 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;13</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00730"/>00730 
<anchor xml:id="__i_r_timer_8hpp_source_1l00731"/>00731 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;(timerEnablSendPWM())</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00732"/>00732 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;(TCD0.CTRLA&#32;=&#32;0)&#32;</emphasis><emphasis role="comment">//&#32;do&#32;not&#32;disable&#32;output,&#32;disable&#32;complete&#32;timer</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00733"/>00733 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00734"/>00734 
<anchor xml:id="__i_r_timer_8hpp_source_1l00735"/>00735 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING&#32;&#32;&#32;&#32;(TCD0.INTFLAGS&#32;=&#32;TCD_OVF_bm)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00736"/>00736 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;(TCD0.INTCTRL&#32;=&#32;TCD_OVF_bm)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00737"/>00737 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;(TCD0.INTCTRL&#32;=&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00738"/>00738 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TCD0_OVF_vect</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00739"/>00739 
<anchor xml:id="__i_r_timer_8hpp_source_1l00740"/>00740 <emphasis role="keywordtype">void</emphasis>&#32;timerEnablSendPWM()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00741"/>00741 &#32;&#32;&#32;&#32;TCD0.CTRLA&#32;=&#32;0;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;reset&#32;enable&#32;bit&#32;in&#32;order&#32;to&#32;unprotect&#32;the&#32;other&#32;bits</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00742"/>00742 &#32;&#32;&#32;&#32;_PROTECTED_WRITE(TCD0.FAULTCTRL,&#32;FUSE_CMPAEN_bm);<emphasis role="comment">//&#32;enable&#32;WOA&#32;output&#32;at&#32;pin&#32;13/PA4</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00743"/>00743 <emphasis role="comment">//&#32;&#32;&#32;&#32;_PROTECTED_WRITE(TCD0.FAULTCTRL,&#32;FUSE_CMPAEN_bm&#32;|&#32;FUSE_CMPBEN_bm);&#32;//&#32;enable&#32;WOA&#32;+&#32;WOB&#32;output&#32;pins&#32;at&#32;13/PA4&#32;+&#32;14/PA5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00744"/>00744 &#32;&#32;&#32;&#32;TCD0.CTRLA&#32;=&#32;TCD_ENABLE_bm&#32;|&#32;TCD_CLKSEL_SYSCLK_gc|&#32;TCD_CNTPRES_DIV1_gc;<emphasis role="comment">//&#32;System&#32;clock,&#32;no&#32;prescale,&#32;no&#32;synchronization&#32;prescaler</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00745"/>00745 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00746"/>00746 
<anchor xml:id="__i_r_timer_8hpp_source_1l00747"/>00747 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00748"/>00748 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;pwmval&#32;=&#32;(F_CPU&#32;/&#32;1000)&#32;/&#32;(aFrequencyKHz);&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;526,31&#32;for&#32;38&#32;kHz&#32;@20&#32;MHz&#32;clock</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00749"/>00749 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;use&#32;one&#32;ramp&#32;mode&#32;and&#32;overflow&#32;interrupt</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00750"/>00750 &#32;&#32;&#32;&#32;TCD0.CTRLA&#32;=&#32;0;<emphasis role="comment">//&#32;reset&#32;enable&#32;bit&#32;in&#32;order&#32;to&#32;unprotect&#32;the&#32;other&#32;bits</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00751"/>00751 <emphasis role="comment">//&#32;&#32;&#32;&#32;while&#32;((TCD0.STATUS&#32;&amp;&#32;TCD_ENRDY_bm)&#32;==&#32;0);&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Wait&#32;for&#32;Enable&#32;Ready&#32;to&#32;be&#32;high&#32;-&#32;I&#32;guess&#32;it&#32;is&#32;not&#32;required</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00752"/>00752 &#32;&#32;&#32;&#32;TCD0.CTRLB&#32;=&#32;TCD_WGMODE_ONERAMP_gc;<emphasis role="comment">//&#32;must&#32;be&#32;set&#32;since&#32;it&#32;is&#32;used&#32;by&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00753"/>00753 &#32;&#32;&#32;&#32;TCD0.CTRLC&#32;=&#32;0;<emphasis role="comment">//&#32;reset&#32;WOx&#32;output&#32;settings</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00754"/>00754 <emphasis role="comment">//&#32;&#32;&#32;&#32;TCD0.CMPBSET&#32;=&#32;80;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00755"/>00755 &#32;&#32;&#32;&#32;TCD0.CMPBCLR&#32;=&#32;pwmval&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00756"/>00756 
<anchor xml:id="__i_r_timer_8hpp_source_1l00757"/>00757 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Generate&#32;duty&#32;cycle&#32;signal&#32;for&#32;debugging&#32;etc.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00758"/>00758 &#32;&#32;&#32;&#32;TCD0.CMPASET&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00759"/>00759 &#32;&#32;&#32;&#32;TCD0.CMPACLR&#32;=&#32;(pwmval&#32;*&#32;<link linkend="__i_rremote_int_8h_1ac534825448d4687e6471c3855bf71cf5">IR_SEND_DUTY_CYCLE</link>&#32;/&#32;100)&#32;-&#32;1;<emphasis role="comment">//&#32;duty&#32;cycle&#32;for&#32;WOA</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00760"/>00760 
<anchor xml:id="__i_r_timer_8hpp_source_1l00761"/>00761 &#32;&#32;&#32;&#32;TCD0.INTFLAGS&#32;=&#32;TCD_OVF_bm;<emphasis role="comment">//&#32;reset&#32;interrupt&#32;flags</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00762"/>00762 &#32;&#32;&#32;&#32;TCD0.INTCTRL&#32;=&#32;TCD_OVF_bm;<emphasis role="comment">//&#32;overflow&#32;interrupt</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00763"/>00763 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Do&#32;not&#32;enable&#32;timer,&#32;this&#32;is&#32;done&#32;at&#32;timerEnablSendPWM()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00764"/>00764 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00765"/>00765 
<anchor xml:id="__i_r_timer_8hpp_source_1l00766"/>00766 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00767"/>00767 &#32;&#32;&#32;&#32;TCD0.CTRLA&#32;=&#32;0;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;reset&#32;enable&#32;bit&#32;in&#32;order&#32;to&#32;unprotect&#32;the&#32;other&#32;bits</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00768"/>00768 &#32;&#32;&#32;&#32;TCD0.CTRLB&#32;=&#32;TCD_WGMODE_ONERAMP_gc;<emphasis role="comment">//&#32;must&#32;be&#32;set&#32;since&#32;it&#32;is&#32;used&#32;by&#32;PWM</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00769"/>00769 <emphasis role="comment">//&#32;&#32;&#32;&#32;TCD0.CMPBSET&#32;=&#32;80;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00770"/>00770 &#32;&#32;&#32;&#32;TCD0.CMPBCLR&#32;=&#32;((F_CPU&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>)&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00771"/>00771 
<anchor xml:id="__i_r_timer_8hpp_source_1l00772"/>00772 &#32;&#32;&#32;&#32;_PROTECTED_WRITE(TCD0.FAULTCTRL,&#32;0);<emphasis role="comment">//&#32;must&#32;disable&#32;WOA&#32;output&#32;at&#32;pin&#32;13/PA4</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00773"/>00773 
<anchor xml:id="__i_r_timer_8hpp_source_1l00774"/>00774 &#32;&#32;&#32;&#32;TCD0.INTFLAGS&#32;=&#32;TCD_OVF_bm;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;reset&#32;interrupt&#32;flags</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00775"/>00775 <emphasis role="comment">//&#32;&#32;&#32;&#32;TCD0.INTCTRL&#32;=&#32;TCD_OVF_bm;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;overflow&#32;interrupt</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00776"/>00776 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;check&#32;enable&#32;ready</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00777"/>00777 <emphasis role="comment">//&#32;&#32;&#32;&#32;while&#32;((TCD0.STATUS&#32;&amp;&#32;TCD_ENRDY_bm)&#32;==&#32;0);&#32;//&#32;Wait&#32;for&#32;Enable&#32;Ready&#32;to&#32;be&#32;high&#32;-&#32;I&#32;guess&#32;it&#32;is&#32;not&#32;required</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00778"/>00778 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;enable&#32;timer&#32;-&#32;this&#32;locks&#32;the&#32;other&#32;bits&#32;and&#32;static&#32;registers&#32;and&#32;activates&#32;values&#32;in&#32;double&#32;buffered&#32;registers</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00779"/>00779 &#32;&#32;&#32;&#32;TCD0.CTRLA&#32;=&#32;TCD_ENABLE_bm&#32;|&#32;TCD_CLKSEL_SYSCLK_gc|&#32;TCD_CNTPRES_DIV1_gc;<emphasis role="comment">//&#32;System&#32;clock,&#32;no&#32;prescale,&#32;no&#32;synchronization&#32;prescaler</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00780"/>00780 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00781"/>00781 
<anchor xml:id="__i_r_timer_8hpp_source_1l00782"/>00782 <emphasis role="preprocessor">#else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00783"/>00783 <emphasis role="preprocessor">#error&#32;Internal&#32;code&#32;configuration&#32;error,&#32;no&#32;timer&#32;functions&#32;implemented&#32;for&#32;this&#32;AVR&#32;CPU&#32;/&#32;board</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00784"/>00784 <emphasis role="preprocessor">#endif&#32;</emphasis><emphasis role="comment">//defined(IR_USE_AVR_TIMER*)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00785"/>00785 
<anchor xml:id="__i_r_timer_8hpp_source_1l00789"/>00789 
<anchor xml:id="__i_r_timer_8hpp_source_1l00792"/>00792 <emphasis role="preprocessor">#elif&#32;defined(__MK20DX128__)&#32;||&#32;defined(__MK20DX256__)&#32;||&#32;defined(__MK64FX512__)&#32;||&#32;defined(__MK66FX1M0__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00793"/>00793 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00794"/>00794 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00795"/>00795 
<anchor xml:id="__i_r_timer_8hpp_source_1l00796"/>00796 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;do&#32;{&#32;CORE_PIN5_CONFIG&#32;=&#32;PORT_PCR_MUX(2)&#32;|&#32;PORT_PCR_DSE&#32;|&#32;PORT_PCR_SRE;&#32;}&#32;while(0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00797"/>00797 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;do&#32;{&#32;CORE_PIN5_CONFIG&#32;=&#32;PORT_PCR_MUX(1)&#32;|&#32;PORT_PCR_DSE&#32;|&#32;PORT_PCR_SRE;&#32;}&#32;while(0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00798"/>00798 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00799"/>00799 
<anchor xml:id="__i_r_timer_8hpp_source_1l00800"/>00800 <emphasis role="comment">//&#32;Special&#32;carrier&#32;modulator&#32;timer&#32;for&#32;Teensy&#32;3.0&#32;/&#32;Teensy&#32;3.1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00801"/>00801 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING&#32;&#32;&#32;&#32;uint8_t&#32;tmp&#32;__attribute__((unused))&#32;=&#32;CMT_MSC;&#32;CMT_CMD2&#32;=&#32;30</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00802"/>00802 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;NVIC_ENABLE_IRQ(IRQ_CMT),&#32;NVIC_SET_PRIORITY(IRQ_CMT,&#32;48)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00803"/>00803 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;NVIC_DISABLE_IRQ(IRQ_CMT)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00804"/>00804 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;cmt_isr</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00805"/>00805 
<anchor xml:id="__i_r_timer_8hpp_source_1l00806"/>00806 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00807"/>00807 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00808"/>00808 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00809"/>00809 <emphasis role="preprocessor">#define&#32;ISR(f)&#32;void&#32;f(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00810"/>00810 
<anchor xml:id="__i_r_timer_8hpp_source_1l00811"/>00811 <emphasis role="preprocessor">#define&#32;CMT_PPS_DIV&#32;&#32;((F_BUS&#32;+&#32;7999999)&#32;/&#32;8000000)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00812"/>00812 <emphasis role="preprocessor">#&#32;&#32;if&#32;F_BUS&#32;&lt;&#32;8000000</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00813"/>00813 <emphasis role="preprocessor">#error&#32;IRremote&#32;requires&#32;at&#32;least&#32;8&#32;MHz&#32;on&#32;Teensy&#32;3.x</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00814"/>00814 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00815"/>00815 
<anchor xml:id="__i_r_timer_8hpp_source_1l00816"/>00816 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00817"/>00817 &#32;&#32;&#32;&#32;SIM_SCGC4&#32;|=&#32;SIM_SCGC4_CMT;
<anchor xml:id="__i_r_timer_8hpp_source_1l00818"/>00818 &#32;&#32;&#32;&#32;SIM_SOPT2&#32;|=&#32;SIM_SOPT2_PTD7PAD;
<anchor xml:id="__i_r_timer_8hpp_source_1l00819"/>00819 &#32;&#32;&#32;&#32;CMT_PPS&#32;=&#32;CMT_PPS_DIV&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00820"/>00820 &#32;&#32;&#32;&#32;CMT_CGH1&#32;=&#32;((F_BUS&#32;/&#32;CMT_PPS_DIV&#32;/&#32;3000)&#32;+&#32;((aFrequencyKHz)&#32;/&#32;2))&#32;/&#32;(aFrequencyKHz);
<anchor xml:id="__i_r_timer_8hpp_source_1l00821"/>00821 &#32;&#32;&#32;&#32;CMT_CGL1&#32;=&#32;((F_BUS&#32;/&#32;CMT_PPS_DIV&#32;/&#32;1500)&#32;+&#32;((aFrequencyKHz)&#32;/&#32;2))&#32;/&#32;(aFrequencyKHz);
<anchor xml:id="__i_r_timer_8hpp_source_1l00822"/>00822 &#32;&#32;&#32;&#32;CMT_CMD1&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00823"/>00823 &#32;&#32;&#32;&#32;CMT_CMD2&#32;=&#32;30;
<anchor xml:id="__i_r_timer_8hpp_source_1l00824"/>00824 &#32;&#32;&#32;&#32;CMT_CMD3&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00825"/>00825 &#32;&#32;&#32;&#32;CMT_CMD4&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00826"/>00826 &#32;&#32;&#32;&#32;CMT_OC&#32;=&#32;0x60;
<anchor xml:id="__i_r_timer_8hpp_source_1l00827"/>00827 &#32;&#32;&#32;&#32;CMT_MSC&#32;=&#32;0x01;
<anchor xml:id="__i_r_timer_8hpp_source_1l00828"/>00828 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00829"/>00829 
<anchor xml:id="__i_r_timer_8hpp_source_1l00830"/>00830 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00831"/>00831 &#32;&#32;&#32;&#32;SIM_SCGC4&#32;|=&#32;SIM_SCGC4_CMT;
<anchor xml:id="__i_r_timer_8hpp_source_1l00832"/>00832 &#32;&#32;&#32;&#32;CMT_PPS&#32;=&#32;CMT_PPS_DIV&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00833"/>00833 &#32;&#32;&#32;&#32;CMT_CGH1&#32;=&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00834"/>00834 &#32;&#32;&#32;&#32;CMT_CGL1&#32;=&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00835"/>00835 &#32;&#32;&#32;&#32;CMT_CMD1&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00836"/>00836 &#32;&#32;&#32;&#32;CMT_CMD2&#32;=&#32;30;
<anchor xml:id="__i_r_timer_8hpp_source_1l00837"/>00837 &#32;&#32;&#32;&#32;CMT_CMD3&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00838"/>00838 &#32;&#32;&#32;&#32;CMT_CMD4&#32;=&#32;(F_BUS&#32;/&#32;160000&#32;+&#32;CMT_PPS_DIV&#32;/&#32;2)&#32;/&#32;CMT_PPS_DIV&#32;-&#32;31;
<anchor xml:id="__i_r_timer_8hpp_source_1l00839"/>00839 &#32;&#32;&#32;&#32;CMT_OC&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00840"/>00840 &#32;&#32;&#32;&#32;CMT_MSC&#32;=&#32;0x03;
<anchor xml:id="__i_r_timer_8hpp_source_1l00841"/>00841 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00842"/>00842 
<anchor xml:id="__i_r_timer_8hpp_source_1l00843"/>00843 
<anchor xml:id="__i_r_timer_8hpp_source_1l00846"/>00846 <emphasis role="preprocessor">#elif&#32;defined(__MKL26Z64__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00847"/>00847 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00848"/>00848 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;16</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00849"/>00849 
<anchor xml:id="__i_r_timer_8hpp_source_1l00850"/>00850 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FTM1_CNT&#32;=&#32;0;&#32;CORE_PIN16_CONFIG&#32;=&#32;PORT_PCR_MUX(3)|PORT_PCR_DSE|PORT_PCR_SRE</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00851"/>00851 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;CORE_PIN16_CONFIG&#32;=&#32;PORT_PCR_MUX(1)|PORT_PCR_SRE</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00852"/>00852 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00853"/>00853 
<anchor xml:id="__i_r_timer_8hpp_source_1l00854"/>00854 <emphasis role="comment">//&#32;defines&#32;for&#32;TPM1&#32;timer&#32;on&#32;Teensy-LC</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00855"/>00855 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FTM1_SC&#32;|=&#32;FTM_SC_TOF;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00856"/>00856 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;&#32;&#32;&#32;&#32;NVIC_ENABLE_IRQ(IRQ_FTM1),&#32;NVIC_SET_PRIORITY(IRQ_FTM1,&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00857"/>00857 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;&#32;&#32;&#32;&#32;NVIC_DISABLE_IRQ(IRQ_FTM1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00858"/>00858 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ftm1_isr</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00859"/>00859 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00860"/>00860 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00861"/>00861 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00862"/>00862 <emphasis role="preprocessor">#define&#32;ISR(f)&#32;void&#32;f(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00863"/>00863 
<anchor xml:id="__i_r_timer_8hpp_source_1l00864"/>00864 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00865"/>00865 &#32;&#32;&#32;&#32;SIM_SCGC6&#32;|=&#32;SIM_SCGC6_TPM1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00866"/>00866 &#32;&#32;&#32;&#32;FTM1_SC&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00867"/>00867 &#32;&#32;&#32;&#32;FTM1_CNT&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00868"/>00868 &#32;&#32;&#32;&#32;FTM1_MOD&#32;=&#32;((F_PLL&#32;/&#32;2000)&#32;/&#32;aFrequencyKHz)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00869"/>00869 &#32;&#32;&#32;&#32;FTM1_C0V&#32;=&#32;((F_PLL&#32;/&#32;6000)&#32;/&#32;aFrequencyKHz)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00870"/>00870 &#32;&#32;&#32;&#32;FTM1_SC&#32;=&#32;FTM_SC_CLKS(1)&#32;|&#32;FTM_SC_PS(0);
<anchor xml:id="__i_r_timer_8hpp_source_1l00871"/>00871 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00872"/>00872 
<anchor xml:id="__i_r_timer_8hpp_source_1l00873"/>00873 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00874"/>00874 &#32;&#32;&#32;&#32;SIM_SCGC6&#32;|=&#32;SIM_SCGC6_TPM1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00875"/>00875 &#32;&#32;&#32;&#32;FTM1_SC&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00876"/>00876 &#32;&#32;&#32;&#32;FTM1_CNT&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00877"/>00877 &#32;&#32;&#32;&#32;FTM1_MOD&#32;=&#32;(F_PLL&#32;/&#32;40000)&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00878"/>00878 &#32;&#32;&#32;&#32;FTM1_C0V&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00879"/>00879 &#32;&#32;&#32;&#32;FTM1_SC&#32;=&#32;FTM_SC_CLKS(1)&#32;|&#32;FTM_SC_PS(0)&#32;|&#32;FTM_SC_TOF&#32;|&#32;FTM_SC_TOIE;
<anchor xml:id="__i_r_timer_8hpp_source_1l00880"/>00880 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00881"/>00881 
<anchor xml:id="__i_r_timer_8hpp_source_1l00882"/>00882 
<anchor xml:id="__i_r_timer_8hpp_source_1l00885"/>00885 <emphasis role="preprocessor">#elif&#32;defined(__IMXRT1062__)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00886"/>00886 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00887"/>00887 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;7</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00888"/>00888 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FLEXPWM1_OUTEN&#32;|=&#32;FLEXPWM_OUTEN_PWMA_EN(8),&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00889"/>00889 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;IOMUXC_SW_MUX_CTL_PAD_GPIO_B1_00&#32;=&#32;6</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00890"/>00890 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;IOMUXC_SW_MUX_CTL_PAD_GPIO_B1_00&#32;=&#32;5,&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00891"/>00891 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FLEXPWM1_OUTEN&#32;&amp;=&#32;~FLEXPWM_OUTEN_PWMA_EN(8)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00892"/>00892 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00893"/>00893 
<anchor xml:id="__i_r_timer_8hpp_source_1l00894"/>00894 <emphasis role="comment">//&#32;defines&#32;for&#32;FlexPWM1&#32;timer&#32;on&#32;Teensy&#32;4</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00895"/>00895 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FLEXPWM1_SM3STS&#32;=&#32;FLEXPWM_SMSTS_RF;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00896"/>00896 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;&#32;&#32;&#32;&#32;attachInterruptVector(IRQ_FLEXPWM1_3,&#32;pwm1_3_isr),\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00897"/>00897 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FLEXPWM1_SM3STS&#32;=&#32;FLEXPWM_SMSTS_RF,&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00898"/>00898 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;FLEXPWM1_SM3INTEN&#32;=&#32;FLEXPWM_SMINTEN_RIE,&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00899"/>00899 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NVIC_ENABLE_IRQ(IRQ_FLEXPWM1_3),&#32;\</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00900"/>00900 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NVIC_SET_PRIORITY(IRQ_FLEXPWM1_3,&#32;48)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00901"/>00901 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;&#32;&#32;&#32;&#32;NVIC_DISABLE_IRQ(IRQ_FLEXPWM1_3)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00902"/>00902 <emphasis role="preprocessor">#define&#32;TIMER_INTR_NAME&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pwm1_3_isr</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00903"/>00903 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00904"/>00904 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00905"/>00905 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00906"/>00906 <emphasis role="preprocessor">#define&#32;ISR(f)&#32;void&#32;(f)(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00907"/>00907 <emphasis role="keywordtype">void</emphasis>&#32;pwm1_3_isr();
<anchor xml:id="__i_r_timer_8hpp_source_1l00908"/>00908 
<anchor xml:id="__i_r_timer_8hpp_source_1l00909"/>00909 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00910"/>00910 &#32;&#32;&#32;&#32;uint32_t&#32;period&#32;=&#32;(float)F_BUS_ACTUAL&#32;/&#32;(<emphasis role="keywordtype">float</emphasis>)((aFrequencyKHz)&#32;*&#32;2000);
<anchor xml:id="__i_r_timer_8hpp_source_1l00911"/>00911 &#32;&#32;&#32;&#32;uint32_t&#32;prescale&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00912"/>00912 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(period&#32;&gt;&#32;32767)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00913"/>00913 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;period&#32;=&#32;period&#32;&gt;&gt;&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00914"/>00914 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(prescale&#32;&lt;&#32;7)&#32;prescale++;
<anchor xml:id="__i_r_timer_8hpp_source_1l00915"/>00915 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l00916"/>00916 &#32;&#32;&#32;&#32;FLEXPWM1_FCTRL0&#32;|=&#32;FLEXPWM_FCTRL0_FLVL(8);
<anchor xml:id="__i_r_timer_8hpp_source_1l00917"/>00917 &#32;&#32;&#32;&#32;FLEXPWM1_FSTS0&#32;=&#32;0x0008;
<anchor xml:id="__i_r_timer_8hpp_source_1l00918"/>00918 &#32;&#32;&#32;&#32;FLEXPWM1_MCTRL&#32;|=&#32;FLEXPWM_MCTRL_CLDOK(8);
<anchor xml:id="__i_r_timer_8hpp_source_1l00919"/>00919 &#32;&#32;&#32;&#32;FLEXPWM1_SM3CTRL2&#32;=&#32;FLEXPWM_SMCTRL2_INDEP;
<anchor xml:id="__i_r_timer_8hpp_source_1l00920"/>00920 &#32;&#32;&#32;&#32;FLEXPWM1_SM3CTRL&#32;=&#32;FLEXPWM_SMCTRL_HALF&#32;|&#32;FLEXPWM_SMCTRL_PRSC(prescale);
<anchor xml:id="__i_r_timer_8hpp_source_1l00921"/>00921 &#32;&#32;&#32;&#32;FLEXPWM1_SM3INIT&#32;=&#32;-period;
<anchor xml:id="__i_r_timer_8hpp_source_1l00922"/>00922 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL0&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00923"/>00923 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL1&#32;=&#32;period;
<anchor xml:id="__i_r_timer_8hpp_source_1l00924"/>00924 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL2&#32;=&#32;-(period&#32;/&#32;3);
<anchor xml:id="__i_r_timer_8hpp_source_1l00925"/>00925 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL3&#32;=&#32;period&#32;/&#32;3;
<anchor xml:id="__i_r_timer_8hpp_source_1l00926"/>00926 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL4&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00927"/>00927 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL5&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00928"/>00928 &#32;&#32;&#32;&#32;FLEXPWM1_MCTRL&#32;|=&#32;FLEXPWM_MCTRL_LDOK(8)&#32;|&#32;FLEXPWM_MCTRL_RUN(8);
<anchor xml:id="__i_r_timer_8hpp_source_1l00929"/>00929 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00930"/>00930 
<anchor xml:id="__i_r_timer_8hpp_source_1l00931"/>00931 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00932"/>00932 &#32;&#32;&#32;&#32;uint32_t&#32;period&#32;=&#32;(float)F_BUS_ACTUAL&#32;*&#32;(<emphasis role="keywordtype">float</emphasis>)(<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>)&#32;*&#32;0.0000005f;
<anchor xml:id="__i_r_timer_8hpp_source_1l00933"/>00933 &#32;&#32;&#32;&#32;uint32_t&#32;prescale&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00934"/>00934 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(period&#32;&gt;&#32;32767)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00935"/>00935 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;period&#32;=&#32;period&#32;&gt;&gt;&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l00936"/>00936 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(prescale&#32;&lt;&#32;7)&#32;prescale++;
<anchor xml:id="__i_r_timer_8hpp_source_1l00937"/>00937 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l00938"/>00938 &#32;&#32;&#32;&#32;FLEXPWM1_FCTRL0&#32;|=&#32;FLEXPWM_FCTRL0_FLVL(8);
<anchor xml:id="__i_r_timer_8hpp_source_1l00939"/>00939 &#32;&#32;&#32;&#32;FLEXPWM1_FSTS0&#32;=&#32;0x0008;
<anchor xml:id="__i_r_timer_8hpp_source_1l00940"/>00940 &#32;&#32;&#32;&#32;FLEXPWM1_MCTRL&#32;|=&#32;FLEXPWM_MCTRL_CLDOK(8);
<anchor xml:id="__i_r_timer_8hpp_source_1l00941"/>00941 &#32;&#32;&#32;&#32;FLEXPWM1_SM3CTRL2&#32;=&#32;FLEXPWM_SMCTRL2_INDEP;
<anchor xml:id="__i_r_timer_8hpp_source_1l00942"/>00942 &#32;&#32;&#32;&#32;FLEXPWM1_SM3CTRL&#32;=&#32;FLEXPWM_SMCTRL_HALF&#32;|&#32;FLEXPWM_SMCTRL_PRSC(prescale);
<anchor xml:id="__i_r_timer_8hpp_source_1l00943"/>00943 &#32;&#32;&#32;&#32;FLEXPWM1_SM3INIT&#32;=&#32;-period;
<anchor xml:id="__i_r_timer_8hpp_source_1l00944"/>00944 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL0&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00945"/>00945 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL1&#32;=&#32;period;
<anchor xml:id="__i_r_timer_8hpp_source_1l00946"/>00946 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL2&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00947"/>00947 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL3&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00948"/>00948 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL4&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00949"/>00949 &#32;&#32;&#32;&#32;FLEXPWM1_SM3VAL5&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l00950"/>00950 &#32;&#32;&#32;&#32;FLEXPWM1_MCTRL&#32;|=&#32;FLEXPWM_MCTRL_LDOK(8)&#32;|&#32;FLEXPWM_MCTRL_RUN(8);
<anchor xml:id="__i_r_timer_8hpp_source_1l00951"/>00951 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00952"/>00952 
<anchor xml:id="__i_r_timer_8hpp_source_1l00953"/>00953 
<anchor xml:id="__i_r_timer_8hpp_source_1l00954"/>00954 <emphasis role="preprocessor">#elif&#32;defined(ESP8266)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00955"/>00955 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00956"/>00956 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;timer1_attachInterrupt(&amp;IRTimerInterruptHandler)&#32;</emphasis><emphasis role="comment">//&#32;enables&#32;interrupt&#32;too</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00957"/>00957 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;timer1_detachInterrupt()&#32;</emphasis><emphasis role="comment">//&#32;disables&#32;interrupt&#32;too</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00958"/>00958 
<anchor xml:id="__i_r_timer_8hpp_source_1l00959"/>00959 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00960"/>00960 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00961"/>00961 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00962"/>00962 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00963"/>00963 <emphasis role="preprocessor">#define&#32;ISR()&#32;IRAM_ATTR&#32;void&#32;IRTimerInterruptHandler()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00964"/>00964 IRAM_ATTR&#32;<emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l00965"/>00965 
<anchor xml:id="__i_r_timer_8hpp_source_1l00966"/>00966 <emphasis role="preprocessor">#ifdef&#32;SEND_PWM_BY_TIMER</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00967"/>00967 <emphasis role="preprocessor">#error&#32;&quot;No&#32;support&#32;for&#32;hardware&#32;PWM&#32;generation&#32;for&#32;ESP8266&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00968"/>00968 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00969"/>00969 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00970"/>00970 &#32;&#32;&#32;&#32;(void)&#32;aFrequencyKHz;
<anchor xml:id="__i_r_timer_8hpp_source_1l00971"/>00971 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00972"/>00972 
<anchor xml:id="__i_r_timer_8hpp_source_1l00973"/>00973 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00974"/>00974 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00975"/>00975 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00976"/>00976 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l00977"/>00977 &#32;&#32;&#32;&#32;timer1_isr_init();
<anchor xml:id="__i_r_timer_8hpp_source_1l00978"/>00978 &#32;&#32;&#32;&#32;<emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00979"/>00979 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;*&#32;TIM_DIV1&#32;=&#32;0,&#32;&#32;&#32;//80MHz&#32;(80&#32;ticks/us&#32;-&#32;104857.588&#32;us&#32;max)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00980"/>00980 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;*&#32;TIM_DIV16&#32;=&#32;1,&#32;&#32;//5MHz&#32;(5&#32;ticks/us&#32;-&#32;1677721.4&#32;us&#32;max)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00981"/>00981 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;*&#32;TIM_DIV256&#32;=&#32;3&#32;&#32;//312.5Khz&#32;(1&#32;tick&#32;=&#32;3.2us&#32;-&#32;26843542.4&#32;us&#32;max)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00982"/>00982 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00983"/>00983 &#32;&#32;&#32;&#32;timer1_enable(TIM_DIV16,&#32;TIM_EDGE,&#32;TIM_LOOP);
<anchor xml:id="__i_r_timer_8hpp_source_1l00984"/>00984 &#32;&#32;&#32;&#32;timer1_write((80&#32;/&#32;16)&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>);&#32;<emphasis role="comment">//&#32;80&#32;for&#32;80&#32;and&#32;160!&#32;MHz&#32;clock,&#32;16&#32;for&#32;TIM_DIV16&#32;above</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00985"/>00985 }
<anchor xml:id="__i_r_timer_8hpp_source_1l00986"/>00986 
<anchor xml:id="__i_r_timer_8hpp_source_1l00987"/>00987 
<anchor xml:id="__i_r_timer_8hpp_source_1l00990"/>00990 <emphasis role="preprocessor">#elif&#32;defined(ESP32)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00991"/>00991 
<anchor xml:id="__i_r_timer_8hpp_source_1l00992"/>00992 <emphasis role="preprocessor">#&#32;&#32;if&#32;!&#32;defined(SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00993"/>00993 <emphasis role="preprocessor">#define&#32;SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL&#32;0&#32;</emphasis><emphasis role="comment">//&#32;The&#32;channel&#32;used&#32;for&#32;PWM&#32;0&#32;to&#32;7&#32;are&#32;high&#32;speed&#32;PWM&#32;channels</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00994"/>00994 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00995"/>00995 
<anchor xml:id="__i_r_timer_8hpp_source_1l00996"/>00996 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00997"/>00997 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;!defined(IR_SEND_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00998"/>00998 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;4&#32;</emphasis><emphasis role="comment">//&#32;can&#32;use&#32;any&#32;pin,&#32;no&#32;timer&#32;restrictions</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l00999"/>00999 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01000"/>01000 
<anchor xml:id="__i_r_timer_8hpp_source_1l01001"/>01001 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;ledcWrite(SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL,&#32;IR_SEND_DUTY_CYCLE)&#32;</emphasis><emphasis role="comment">//&#32;we&#32;must&#32;use&#32;channel&#32;here&#32;not&#32;pin&#32;number</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01002"/>01002 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;ledcWrite(SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL,&#32;0)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01003"/>01003 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01004"/>01004 
<anchor xml:id="__i_r_timer_8hpp_source_1l01005"/>01005 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01006"/>01006 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;timerAlarmEnable(sESP32Timer)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01007"/>01007 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;if&#32;(sESP32Timer&#32;!=&#32;NULL)&#32;{timerEnd(sESP32Timer);&#32;timerDetachInterrupt(sESP32Timer);}</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01008"/>01008 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01009"/>01009 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01010"/>01010 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01011"/>01011 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01012"/>01012 <emphasis role="preprocessor">#define&#32;ISR()&#32;IRAM_ATTR&#32;void&#32;IRTimerInterruptHandler()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01013"/>01013 IRAM_ATTR&#32;<emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01014"/>01014 
<anchor xml:id="__i_r_timer_8hpp_source_1l01015"/>01015 <emphasis role="comment">//&#32;Variables&#32;specific&#32;to&#32;the&#32;ESP32.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01016"/>01016 <emphasis role="comment">//&#32;the&#32;ledc&#32;functions&#32;behave&#32;like&#32;hardware&#32;timers&#32;for&#32;us&#32;:-),&#32;so&#32;we&#32;do&#32;not&#32;require&#32;our&#32;own&#32;soft&#32;PWM&#32;generation&#32;code.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01017"/>01017 hw_timer_t&#32;*sESP32Timer;
<anchor xml:id="__i_r_timer_8hpp_source_1l01018"/>01018 
<anchor xml:id="__i_r_timer_8hpp_source_1l01019"/>01019 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01020"/>01020 &#32;&#32;&#32;&#32;ledcSetup(SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL,&#32;aFrequencyKHz&#32;*&#32;1000,&#32;8);&#32;&#32;<emphasis role="comment">//&#32;8&#32;bit&#32;PWM&#32;resolution</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01021"/>01021 <emphasis role="preprocessor">#if&#32;defined(IR_SEND_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01022"/>01022 &#32;&#32;&#32;&#32;ledcAttachPin(IR_SEND_PIN,&#32;SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL);<emphasis role="comment">//&#32;bind&#32;pin&#32;to&#32;channel</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01023"/>01023 <emphasis role="preprocessor">#else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01024"/>01024 &#32;&#32;&#32;&#32;ledcAttachPin(<link linkend="_group___sending_1gafba8232b747be85f72c1c4612780d5cf">IrSender</link>.<link linkend="_class_i_rsend_1a39f9782dd884b804bcf0034ab71ac202">sendPin</link>,&#32;SEND_AND_RECEIVE_TIMER_LEDC_CHANNEL);<emphasis role="comment">//&#32;bind&#32;pin&#32;to&#32;channel</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01025"/>01025 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01026"/>01026 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01027"/>01027 
<anchor xml:id="__i_r_timer_8hpp_source_1l01028"/>01028 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01029"/>01029 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01030"/>01030 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01031"/>01031 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01032"/>01032 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;ESP32&#32;has&#32;a&#32;proper&#32;API&#32;to&#32;setup&#32;timers,&#32;no&#32;weird&#32;chip&#32;macros&#32;needed</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01033"/>01033 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;simply&#32;call&#32;the&#32;readable&#32;API&#32;versions&#32;:)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01034"/>01034 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;3&#32;timers,&#32;choose&#32;#1,&#32;80&#32;divider&#32;for&#32;microsecond&#32;precision&#32;@80MHz&#32;clock,&#32;count_up&#32;=&#32;true</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01035"/>01035 &#32;&#32;&#32;&#32;sESP32Timer&#32;=&#32;timerBegin(1,&#32;80,&#32;<emphasis role="keyword">true</emphasis>);
<anchor xml:id="__i_r_timer_8hpp_source_1l01036"/>01036 &#32;&#32;&#32;&#32;timerAttachInterrupt(sESP32Timer,&#32;&amp;IRTimerInterruptHandler,&#32;1);
<anchor xml:id="__i_r_timer_8hpp_source_1l01037"/>01037 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;every&#32;50&#32;us,&#32;autoreload&#32;=&#32;true</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01038"/>01038 &#32;&#32;&#32;&#32;timerAlarmWrite(sESP32Timer,&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>,&#32;<emphasis role="keyword">true</emphasis>);
<anchor xml:id="__i_r_timer_8hpp_source_1l01039"/>01039 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01040"/>01040 
<anchor xml:id="__i_r_timer_8hpp_source_1l01041"/>01041 
<anchor xml:id="__i_r_timer_8hpp_source_1l01044"/>01044 <emphasis role="preprocessor">#elif&#32;defined(ARDUINO_ARCH_SAMD)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01045"/>01045 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01046"/>01046 <emphasis role="preprocessor">#error&#32;PWM&#32;generation&#32;by&#32;hardware&#32;not&#32;implemented&#32;for&#32;SAMD</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01047"/>01047 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01048"/>01048 
<anchor xml:id="__i_r_timer_8hpp_source_1l01049"/>01049 <emphasis role="comment">//&#32;use&#32;Timer&#32;TC3&#32;here</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01050"/>01050 <emphasis role="preprocessor">#&#32;&#32;if&#32;!defined(IR_SAMD_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01051"/>01051 <emphasis role="preprocessor">#define&#32;IR_SAMD_TIMER&#32;&#32;&#32;&#32;&#32;&#32;&#32;TC3</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01052"/>01052 <emphasis role="preprocessor">#define&#32;IR_SAMD_TIMER_ID&#32;&#32;&#32;&#32;GCLK_CLKCTRL_ID_TCC2_TC3</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01053"/>01053 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01054"/>01054 
<anchor xml:id="__i_r_timer_8hpp_source_1l01055"/>01055 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01056"/>01056 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;NVIC_EnableIRQ(TC3_IRQn)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01057"/>01057 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;NVIC_DisableIRQ(TC3_IRQn)&#32;</emphasis><emphasis role="comment">//&#32;or&#32;TC3-&gt;COUNT16.CTRLA.reg&#32;&amp;=&#32;~TC_CTRLA_ENABLE;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01058"/>01058 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01059"/>01059 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01060"/>01060 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01061"/>01061 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01062"/>01062 <emphasis role="preprocessor">#define&#32;ISR(f)&#32;void&#32;IRTimerInterruptHandler(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01063"/>01063 <emphasis role="comment">//&#32;ATSAMD&#32;Timer&#32;IRQ&#32;functions</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01064"/>01064 <emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01065"/>01065 
<anchor xml:id="__i_r_timer_8hpp_source_1l01066"/>01066 <emphasis role="preprocessor">#define&#32;TIMER_PRESCALER_DIV&#32;64</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01067"/>01067 
<anchor xml:id="__i_r_timer_8hpp_source_1l01068"/>01068 <emphasis role="keywordtype">void</emphasis>&#32;setTimerFrequency(<emphasis role="keywordtype">unsigned</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;aFrequencyHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01069"/>01069 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;compareValue&#32;=&#32;(F_CPU&#32;/&#32;(TIMER_PRESCALER_DIV&#32;*&#32;aFrequencyHz))&#32;-&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l01070"/>01070 &#32;&#32;&#32;&#32;<emphasis role="comment">//Serial.println(compareValue);</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01071"/>01071 &#32;&#32;&#32;&#32;TcCount16&#32;*TC&#32;=&#32;(TcCount16*)&#32;IR_SAMD_TIMER;
<anchor xml:id="__i_r_timer_8hpp_source_1l01072"/>01072 &#32;&#32;&#32;&#32;TC-&gt;COUNT.reg&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l01073"/>01073 &#32;&#32;&#32;&#32;TC-&gt;CC[0].reg&#32;=&#32;compareValue;
<anchor xml:id="__i_r_timer_8hpp_source_1l01074"/>01074 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(TC-&gt;STATUS.bit.SYNCBUSY&#32;==&#32;1)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01075"/>01075 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l01076"/>01076 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01077"/>01077 
<anchor xml:id="__i_r_timer_8hpp_source_1l01078"/>01078 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01079"/>01079 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01080"/>01080 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01081"/>01081 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01082"/>01082 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Clock&#32;source&#32;is&#32;Generic&#32;clock&#32;generator&#32;0;&#32;enable</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01083"/>01083 &#32;&#32;&#32;&#32;REG_GCLK_CLKCTRL&#32;=&#32;(uint16_t)&#32;(GCLK_CLKCTRL_CLKEN&#32;|&#32;GCLK_CLKCTRL_GEN_GCLK0&#32;|&#32;IR_SAMD_TIMER_ID);
<anchor xml:id="__i_r_timer_8hpp_source_1l01084"/>01084 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(GCLK-&gt;STATUS.bit.SYNCBUSY&#32;==&#32;1)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01085"/>01085 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l01086"/>01086 
<anchor xml:id="__i_r_timer_8hpp_source_1l01087"/>01087 &#32;&#32;&#32;&#32;TcCount16&#32;*TC&#32;=&#32;(TcCount16*)&#32;IR_SAMD_TIMER;&#32;<emphasis role="comment">//&#32;Timer&#32;3</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01088"/>01088 
<anchor xml:id="__i_r_timer_8hpp_source_1l01089"/>01089 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;The&#32;TC&#32;should&#32;be&#32;disabled&#32;before&#32;the&#32;TC&#32;is&#32;reset&#32;in&#32;order&#32;to&#32;avoid&#32;undefined&#32;behavior.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01090"/>01090 &#32;&#32;&#32;&#32;TC-&gt;CTRLA.reg&#32;&amp;=&#32;~TC_CTRLA_ENABLE;
<anchor xml:id="__i_r_timer_8hpp_source_1l01091"/>01091 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;When&#32;write-synchronization&#32;is&#32;ongoing&#32;for&#32;a&#32;register,&#32;any&#32;subsequent&#32;write&#32;attempts&#32;to&#32;this&#32;register&#32;will&#32;be&#32;discarded,&#32;and&#32;an&#32;error&#32;will&#32;be&#32;reported.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01092"/>01092 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(TC-&gt;STATUS.bit.SYNCBUSY&#32;==&#32;1)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01093"/>01093 &#32;&#32;&#32;&#32;}&#32;<emphasis role="comment">//&#32;wait&#32;for&#32;sync</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01094"/>01094 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Reset&#32;TCx</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01095"/>01095 &#32;&#32;&#32;&#32;TC-&gt;CTRLA.reg&#32;=&#32;TC_CTRLA_SWRST;
<anchor xml:id="__i_r_timer_8hpp_source_1l01096"/>01096 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;When&#32;writing&#32;a&#32;1&#32;to&#32;the&#32;CTRLA.SWRST&#32;bit&#32;it&#32;will&#32;immediately&#32;read&#32;as&#32;1.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01097"/>01097 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;CTRL.SWRST&#32;will&#32;be&#32;cleared&#32;by&#32;hardware&#32;when&#32;the&#32;peripheral&#32;has&#32;been&#32;reset.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01098"/>01098 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(TC-&gt;CTRLA.bit.SWRST)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01099"/>01099 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l01100"/>01100 
<anchor xml:id="__i_r_timer_8hpp_source_1l01101"/>01101 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Use&#32;the&#32;16-bit&#32;timer</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01102"/>01102 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Use&#32;match&#32;mode&#32;so&#32;that&#32;the&#32;timer&#32;counter&#32;resets&#32;when&#32;the&#32;count&#32;matches&#32;the&#32;compare&#32;register</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01103"/>01103 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Set&#32;prescaler&#32;to&#32;64</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01104"/>01104 &#32;&#32;&#32;&#32;TC-&gt;CTRLA.reg&#32;|=&#32;TC_CTRLA_MODE_COUNT16&#32;|&#32;TC_CTRLA_WAVEGEN_MFRQ&#32;|&#32;TC_CTRLA_PRESCALER_DIV64&#32;|&#32;TC_CTRLA_ENABLE;
<anchor xml:id="__i_r_timer_8hpp_source_1l01105"/>01105 
<anchor xml:id="__i_r_timer_8hpp_source_1l01106"/>01106 &#32;&#32;&#32;&#32;setTimerFrequency(<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>&#32;/&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>);
<anchor xml:id="__i_r_timer_8hpp_source_1l01107"/>01107 
<anchor xml:id="__i_r_timer_8hpp_source_1l01108"/>01108 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Enable&#32;the&#32;compare&#32;interrupt</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01109"/>01109 &#32;&#32;&#32;&#32;TC-&gt;INTENSET.reg&#32;=&#32;0;
<anchor xml:id="__i_r_timer_8hpp_source_1l01110"/>01110 &#32;&#32;&#32;&#32;TC-&gt;INTENSET.bit.MC0&#32;=&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l01111"/>01111 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01112"/>01112 
<anchor xml:id="__i_r_timer_8hpp_source_1l01113"/>01113 <emphasis role="keywordtype">void</emphasis>&#32;TC3_Handler(<emphasis role="keywordtype">void</emphasis>)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01114"/>01114 &#32;&#32;&#32;&#32;TcCount16&#32;*TC&#32;=&#32;(TcCount16*)&#32;IR_SAMD_TIMER;
<anchor xml:id="__i_r_timer_8hpp_source_1l01115"/>01115 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Check&#32;for&#32;right&#32;interrupt&#32;bit</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01116"/>01116 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(TC-&gt;INTFLAG.bit.MC0&#32;==&#32;1)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01117"/>01117 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;reset&#32;bit&#32;for&#32;next&#32;turn</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01118"/>01118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TC-&gt;INTFLAG.bit.MC0&#32;=&#32;1;
<anchor xml:id="__i_r_timer_8hpp_source_1l01119"/>01119 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01120"/>01120 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l01121"/>01121 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01122"/>01122 
<anchor xml:id="__i_r_timer_8hpp_source_1l01123"/>01123 
<anchor xml:id="__i_r_timer_8hpp_source_1l01126"/>01126 <emphasis role="preprocessor">#elif&#32;defined(ARDUINO_ARCH_MBED)&#32;</emphasis><emphasis role="comment">//&#32;Arduino&#32;Nano&#32;33&#32;BLE&#32;+&#32;Sparkfun&#32;Apollo3</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01127"/>01127 <emphasis role="preprocessor">#include&#32;&quot;mbed.h&quot;</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01128"/>01128 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01129"/>01129 <emphasis role="preprocessor">#error&#32;PWM&#32;generation&#32;by&#32;hardware&#32;not&#32;implemented&#32;for&#32;MBED</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01130"/>01130 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01131"/>01131 
<anchor xml:id="__i_r_timer_8hpp_source_1l01132"/>01132 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01133"/>01133 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;sMbedTimer.attach(IRTimerInterruptHandler,&#32;std::chrono::microseconds(MICROS_PER_TICK));</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01134"/>01134 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;sMbedTimer.detach();</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01135"/>01135 
<anchor xml:id="__i_r_timer_8hpp_source_1l01136"/>01136 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01137"/>01137 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01138"/>01138 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01139"/>01139 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01140"/>01140 <emphasis role="preprocessor">#define&#32;ISR()&#32;void&#32;IRTimerInterruptHandler(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01141"/>01141 <emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01142"/>01142 
<anchor xml:id="__i_r_timer_8hpp_source_1l01143"/>01143 mbed::Ticker&#32;sMbedTimer;
<anchor xml:id="__i_r_timer_8hpp_source_1l01144"/>01144 
<anchor xml:id="__i_r_timer_8hpp_source_1l01145"/>01145 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01146"/>01146 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01147"/>01147 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01148"/>01148 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01149"/>01149 &#32;&#32;&#32;&#32;sMbedTimer.attach(IRTimerInterruptHandler,&#32;std::chrono::microseconds(<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>));
<anchor xml:id="__i_r_timer_8hpp_source_1l01150"/>01150 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01151"/>01151 
<anchor xml:id="__i_r_timer_8hpp_source_1l01152"/>01152 
<anchor xml:id="__i_r_timer_8hpp_source_1l01155"/>01155 <emphasis role="preprocessor">#elif&#32;defined(NRF5)&#32;||&#32;defined(ARDUINO_ARCH_NRF52840)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01156"/>01156 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01157"/>01157 <emphasis role="preprocessor">#error&#32;PWM&#32;generation&#32;by&#32;hardware&#32;not&#32;implemented&#32;for&#32;NRF5</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01158"/>01158 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01159"/>01159 
<anchor xml:id="__i_r_timer_8hpp_source_1l01160"/>01160 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01161"/>01161 <emphasis role="comment">//&#32;The&#32;default&#32;pin&#32;used&#32;used&#32;for&#32;sending.&#32;3,&#32;A0&#32;-&#32;left&#32;pad</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01162"/>01162 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;3&#32;</emphasis><emphasis role="comment">//&#32;dummy&#32;since&#32;sending&#32;not&#32;yet&#32;supported</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01163"/>01163 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01164"/>01164 
<anchor xml:id="__i_r_timer_8hpp_source_1l01165"/>01165 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01166"/>01166 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;NVIC_EnableIRQ(TIMER2_IRQn);</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01167"/>01167 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;NVIC_DisableIRQ(TIMER2_IRQn);</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01168"/>01168 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01169"/>01169 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01170"/>01170 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01171"/>01171 <emphasis role="preprocessor">#define&#32;ISR(f)&#32;void&#32;IRTimerInterruptHandler(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01172"/>01172 <emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01173"/>01173 
<anchor xml:id="__i_r_timer_8hpp_source_1l01174"/>01174 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01175"/>01175 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01176"/>01176 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01177"/>01177 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01178"/>01178 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;MODE&#32;=&#32;TIMER_MODE_MODE_Timer;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Set&#32;the&#32;timer&#32;in&#32;Timer&#32;Mode</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01179"/>01179 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;TASKS_CLEAR&#32;=&#32;1;<emphasis role="comment">//&#32;clear&#32;the&#32;task&#32;first&#32;to&#32;be&#32;usable&#32;for&#32;later</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01180"/>01180 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;PRESCALER&#32;=&#32;4;<emphasis role="comment">//&#32;f&#32;TIMER&#32;=&#32;16&#32;MHz&#32;/&#32;(2&#32;^&#32;PRESCALER&#32;)&#32;:&#32;4&#32;-&gt;&#32;1&#32;MHz,&#32;1&#32;uS</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01181"/>01181 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;BITMODE&#32;=&#32;TIMER_BITMODE_BITMODE_16Bit;<emphasis role="comment">//Set&#32;counter&#32;to&#32;16&#32;bit&#32;resolution</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01182"/>01182 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;CC[0]&#32;=&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>;<emphasis role="comment">//Set&#32;value&#32;for&#32;TIMER2&#32;compare&#32;register&#32;0,&#32;to&#32;trigger&#32;every&#32;50&#32;uS</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01183"/>01183 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;CC[1]&#32;=&#32;0;<emphasis role="comment">//Set&#32;value&#32;for&#32;TIMER2&#32;compare&#32;register&#32;1</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01184"/>01184 
<anchor xml:id="__i_r_timer_8hpp_source_1l01185"/>01185 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Enable&#32;interrupt&#32;on&#32;Timer&#32;2,&#32;for&#32;CC[0]&#32;compare&#32;match&#32;events</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01186"/>01186 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;INTENSET&#32;=&#32;(TIMER_INTENSET_COMPARE0_Enabled&#32;&lt;&lt;&#32;TIMER_INTENSET_COMPARE0_Pos);
<anchor xml:id="__i_r_timer_8hpp_source_1l01187"/>01187 &#32;&#32;&#32;&#32;NRF_TIMER2-&gt;TASKS_START&#32;=&#32;1;<emphasis role="comment">//&#32;Start&#32;TIMER2</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01188"/>01188 
<anchor xml:id="__i_r_timer_8hpp_source_1l01189"/>01189 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;timerAttachInterrupt(timer,&#32;&amp;IRTimerInterruptHandler,&#32;1);</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01190"/>01190 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01191"/>01191 
<anchor xml:id="__i_r_timer_8hpp_source_1l01195"/>01195 <emphasis role="keyword">extern</emphasis>&#32;<emphasis role="stringliteral">&quot;C&quot;</emphasis>&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01196"/>01196 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;TIMER2_IRQHandler(<emphasis role="keywordtype">void</emphasis>)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01197"/>01197 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Interrupt&#32;Service&#32;Routine&#32;-&#32;Fires&#32;every&#32;50uS</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01198"/>01198 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;((NRF_TIMER2-&gt;EVENTS_COMPARE[0]&#32;!=&#32;0)&#32;&amp;&amp;&#32;((NRF_TIMER2-&gt;INTENSET&#32;&amp;&#32;TIMER_INTENSET_COMPARE0_Msk)&#32;!=&#32;0))&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01199"/>01199 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NRF_TIMER2-&gt;EVENTS_COMPARE[0]&#32;=&#32;0;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//Clear&#32;compare&#32;register&#32;0&#32;event</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01200"/>01200 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;IRTimerInterruptHandler();<emphasis role="comment">//&#32;call&#32;the&#32;IR-receive&#32;function</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01201"/>01201 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NRF_TIMER2-&gt;CC[0]&#32;+=&#32;50;
<anchor xml:id="__i_r_timer_8hpp_source_1l01202"/>01202 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l01203"/>01203 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i_r_timer_8hpp_source_1l01204"/>01204 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01205"/>01205 
<anchor xml:id="__i_r_timer_8hpp_source_1l01206"/>01206 
<anchor xml:id="__i_r_timer_8hpp_source_1l01213"/>01213 <emphasis role="preprocessor">#elif&#32;defined(__STM32F1__)&#32;||&#32;defined(ARDUINO_ARCH_STM32F1)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01214"/>01214 <emphasis role="preprocessor">#include&#32;&lt;HardwareTimer.h&gt;</emphasis>&#32;<emphasis role="comment">//&#32;4&#32;timers&#32;and&#32;4.&#32;timer&#32;(4.channel)&#32;is&#32;used&#32;for&#32;tone()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01215"/>01215 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01216"/>01216 <emphasis role="preprocessor">#error&#32;PWM&#32;generation&#32;by&#32;hardware&#32;not&#32;implemented&#32;for&#32;STM32</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01217"/>01217 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01218"/>01218 
<anchor xml:id="__i_r_timer_8hpp_source_1l01219"/>01219 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01220"/>01220 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;sSTM32Timer.resume()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01221"/>01221 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;sSTM32Timer.pause()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01222"/>01222 
<anchor xml:id="__i_r_timer_8hpp_source_1l01223"/>01223 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01224"/>01224 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01225"/>01225 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01226"/>01226 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01227"/>01227 <emphasis role="preprocessor">#define&#32;ISR()&#32;void&#32;IRTimerInterruptHandler(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01228"/>01228 <emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01229"/>01229 
<anchor xml:id="__i_r_timer_8hpp_source_1l01230"/>01230 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01231"/>01231 <emphasis role="comment">&#32;*&#32;Use&#32;timer&#32;3&#32;as&#32;IR&#32;timer.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01232"/>01232 <emphasis role="comment">&#32;*&#32;Timer&#32;3&#32;blocks&#32;PA6,&#32;PA7,&#32;PB0,&#32;PB1,&#32;so&#32;if&#32;you&#32;require&#32;one&#32;of&#32;them&#32;as&#32;tone()&#32;or&#32;Servo&#32;output,&#32;you&#32;must&#32;choose&#32;another&#32;timer.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01233"/>01233 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01234"/>01234 HardwareTimer&#32;sSTM32Timer(3);
<anchor xml:id="__i_r_timer_8hpp_source_1l01235"/>01235 
<anchor xml:id="__i_r_timer_8hpp_source_1l01236"/>01236 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01237"/>01237 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01238"/>01238 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01239"/>01239 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01240"/>01240 &#32;&#32;&#32;&#32;sSTM32Timer.setMode(TIMER_CH1,&#32;TIMER_OUTPUT_COMPARE);
<anchor xml:id="__i_r_timer_8hpp_source_1l01241"/>01241 &#32;&#32;&#32;&#32;sSTM32Timer.setPrescaleFactor(1);
<anchor xml:id="__i_r_timer_8hpp_source_1l01242"/>01242 &#32;&#32;&#32;&#32;sSTM32Timer.setOverflow((F_CPU&#32;/&#32;<link linkend="__i_rremote_int_8h_1af33c8a218dd35ede965cf20a68a0068d">MICROS_IN_ONE_SECOND</link>)&#32;*&#32;<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>);
<anchor xml:id="__i_r_timer_8hpp_source_1l01243"/>01243 &#32;&#32;&#32;&#32;sSTM32Timer.attachInterrupt(TIMER_CH1,&#32;IRTimerInterruptHandler);
<anchor xml:id="__i_r_timer_8hpp_source_1l01244"/>01244 &#32;&#32;&#32;&#32;sSTM32Timer.refresh();
<anchor xml:id="__i_r_timer_8hpp_source_1l01245"/>01245 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01246"/>01246 
<anchor xml:id="__i_r_timer_8hpp_source_1l01247"/>01247 
<anchor xml:id="__i_r_timer_8hpp_source_1l01252"/>01252 <emphasis role="preprocessor">#elif&#32;defined(STM32F1xx)&#32;||&#32;defined(ARDUINO_ARCH_STM32)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01253"/>01253 <emphasis role="preprocessor">#include&#32;&lt;HardwareTimer.h&gt;</emphasis>&#32;<emphasis role="comment">//&#32;4&#32;timers&#32;and&#32;3.&#32;timer&#32;is&#32;used&#32;for&#32;tone(),&#32;2.&#32;for&#32;Servo</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01254"/>01254 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01255"/>01255 <emphasis role="preprocessor">#error&#32;PWM&#32;generation&#32;by&#32;hardware&#32;not&#32;implemented&#32;for&#32;STM32</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01256"/>01256 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01257"/>01257 
<anchor xml:id="__i_r_timer_8hpp_source_1l01258"/>01258 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01259"/>01259 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;sSTM32Timer.resume()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01260"/>01260 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;sSTM32Timer.pause()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01261"/>01261 
<anchor xml:id="__i_r_timer_8hpp_source_1l01262"/>01262 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01263"/>01263 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01264"/>01264 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01265"/>01265 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01266"/>01266 <emphasis role="preprocessor">#define&#32;ISR()&#32;void&#32;IRTimerInterruptHandler(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01267"/>01267 <emphasis role="keywordtype">void</emphasis>&#32;IRTimerInterruptHandler();
<anchor xml:id="__i_r_timer_8hpp_source_1l01268"/>01268 
<anchor xml:id="__i_r_timer_8hpp_source_1l01269"/>01269 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01270"/>01270 <emphasis role="comment">&#32;*&#32;Use&#32;timer&#32;4&#32;as&#32;IR&#32;timer.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01271"/>01271 <emphasis role="comment">&#32;*&#32;Timer&#32;4&#32;blocks&#32;PB6,&#32;PB7,&#32;PB8,&#32;PB9,&#32;so&#32;if&#32;you&#32;need&#32;one&#32;them&#32;as&#32;tone()&#32;or&#32;Servo&#32;output,&#32;you&#32;must&#32;choose&#32;another&#32;timer.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01272"/>01272 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01273"/>01273 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(TIM4)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01274"/>01274 HardwareTimer&#32;sSTM32Timer(TIM4);
<anchor xml:id="__i_r_timer_8hpp_source_1l01275"/>01275 <emphasis role="preprocessor">#&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01276"/>01276 HardwareTimer&#32;sSTM32Timer(TIM2);
<anchor xml:id="__i_r_timer_8hpp_source_1l01277"/>01277 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01278"/>01278 
<anchor xml:id="__i_r_timer_8hpp_source_1l01279"/>01279 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01280"/>01280 <emphasis role="comment">&#32;*&#32;Set&#32;timer&#32;for&#32;interrupts&#32;every&#32;MICROS_PER_TICK&#32;(50&#32;us)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01281"/>01281 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01282"/>01282 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01283"/>01283 &#32;&#32;&#32;&#32;sSTM32Timer.setOverflow(<link linkend="__i_rremote_int_8h_1a1c7eebb527483c272812530caa313d20">MICROS_PER_TICK</link>,&#32;MICROSEC_FORMAT);&#32;<emphasis role="comment">//&#32;50&#32;uS</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01284"/>01284 &#32;&#32;&#32;&#32;sSTM32Timer.attachInterrupt(IRTimerInterruptHandler);
<anchor xml:id="__i_r_timer_8hpp_source_1l01285"/>01285 &#32;&#32;&#32;&#32;sSTM32Timer.resume();
<anchor xml:id="__i_r_timer_8hpp_source_1l01286"/>01286 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01287"/>01287 
<anchor xml:id="__i_r_timer_8hpp_source_1l01288"/>01288 
<anchor xml:id="__i_r_timer_8hpp_source_1l01292"/>01292 <emphasis role="preprocessor">#elif&#32;defined(PARTICLE)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01293"/>01293 <emphasis role="preprocessor">#&#32;&#32;ifndef&#32;__INTERVALTIMER_H__</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01294"/>01294 <emphasis role="preprocessor">#include&#32;&quot;SparkIntervalTimer.h&quot;</emphasis>&#32;<emphasis role="comment">//&#32;SparkIntervalTimer.h&#32;is&#32;required&#32;if&#32;PARTICLE&#32;is&#32;defined.</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01295"/>01295 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01296"/>01296 
<anchor xml:id="__i_r_timer_8hpp_source_1l01297"/>01297 <emphasis role="preprocessor">#&#32;&#32;if&#32;defined(SEND_PWM_BY_TIMER)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01298"/>01298 <emphasis role="preprocessor">#define&#32;IR_SEND_PIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;A5&#32;</emphasis><emphasis role="comment">//&#32;Particle&#32;supports&#32;multiple&#32;pins</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01299"/>01299 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;if&#32;defined(IR_SEND_PIN)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01300"/>01300 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;analogWrite(IR_SEND_PIN,&#32;128,&#32;ir_out_kHz*1000)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01301"/>01301 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;analogWrite(IR_SEND_PIN,&#32;0,&#32;ir_out_kHz*1000)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01302"/>01302 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01303"/>01303 <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;&#32;analogWrite(IrSender.sendPin,&#32;128,&#32;ir_out_kHz*1000)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01304"/>01304 <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER&#32;&#32;&#32;analogWrite(IrSender.sendPin,&#32;0,&#32;ir_out_kHz*1000)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01305"/>01305 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01306"/>01306 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01307"/>01307 
<anchor xml:id="__i_r_timer_8hpp_source_1l01308"/>01308 <emphasis role="preprocessor">#&#32;&#32;ifndef&#32;IR_OUT_KHZ</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01309"/>01309 <emphasis role="preprocessor">#define&#32;IR_OUT_KHZ&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;38&#32;</emphasis><emphasis role="comment">//&#32;default&#32;set&#32;to&#32;38&#32;KHz</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01310"/>01310 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01311"/>01311 
<anchor xml:id="__i_r_timer_8hpp_source_1l01312"/>01312 <emphasis role="keyword">extern</emphasis>&#32;IntervalTimer&#32;timer;
<anchor xml:id="__i_r_timer_8hpp_source_1l01313"/>01313 <emphasis role="keyword">extern</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;ir_out_kHz;
<anchor xml:id="__i_r_timer_8hpp_source_1l01314"/>01314 <emphasis role="comment">//void&#32;IRTimerInterruptHandler();</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01315"/>01315 
<anchor xml:id="__i_r_timer_8hpp_source_1l01316"/>01316 <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01317"/>01317 <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR&#32;&#32;&#32;timer.begin(IRTimerInterruptHandler,&#32;MICROS_PER_TICK,&#32;uSec)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01318"/>01318 <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR&#32;&#32;timer.end()</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01319"/>01319 
<anchor xml:id="__i_r_timer_8hpp_source_1l01320"/>01320 <emphasis role="comment">//&#32;Redefinition&#32;of&#32;ISR&#32;macro&#32;which&#32;creates&#32;a&#32;plain&#32;function&#32;now</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01321"/>01321 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01322"/>01322 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01323"/>01323 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01324"/>01324 <emphasis role="preprocessor">#define&#32;ISR()&#32;void&#32;IRTimerInterruptHandler(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01325"/>01325 
<anchor xml:id="__i_r_timer_8hpp_source_1l01326"/>01326 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01327"/>01327 &#32;&#32;&#32;&#32;ir_out_kHz&#32;=&#32;aFrequencyKHz;
<anchor xml:id="__i_r_timer_8hpp_source_1l01328"/>01328 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01329"/>01329 
<anchor xml:id="__i_r_timer_8hpp_source_1l01330"/>01330 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01331"/>01331 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01332"/>01332 
<anchor xml:id="__i_r_timer_8hpp_source_1l01333"/>01333 
<anchor xml:id="__i_r_timer_8hpp_source_1l01336"/>01336 <emphasis role="preprocessor">#else</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01337"/>01337 <emphasis role="preprocessor">#error&#32;Internal&#32;code&#32;configuration&#32;error,&#32;no&#32;timer&#32;functions&#32;implemented&#32;for&#32;this&#32;CPU&#32;/&#32;board</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01338"/>01338 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01339"/>01339 <emphasis role="comment">&#32;*&#32;Dummy&#32;definitions&#32;to&#32;avoid&#32;more&#32;irritating&#32;compile&#32;errors</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01340"/>01340 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01341"/><link linkend="_group___timer_1ga56882eeb7842d9b52bb5c36febad0ccd">01341</link> <emphasis role="preprocessor">#define&#32;TIMER_RESET_INTR_PENDING</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01342"/><link linkend="_group___timer_1ga188e83488bfec8bb484bbaa96cfbdc5a">01342</link> <emphasis role="preprocessor">#define&#32;ENABLE_SEND_PWM_BY_TIMER</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01343"/><link linkend="_group___timer_1ga00c73e29496913c8cff34b1a12c613ab">01343</link> <emphasis role="preprocessor">#define&#32;DISABLE_SEND_PWM_BY_TIMER</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01344"/><link linkend="_group___timer_1ga3127b57492af4dfc90ddacf40c6162d0">01344</link> <emphasis role="preprocessor">#define&#32;TIMER_ENABLE_RECEIVE_INTR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01345"/><link linkend="_group___timer_1gaa526c768d410a407fb5433f7662527a7">01345</link> <emphasis role="preprocessor">#define&#32;TIMER_DISABLE_RECEIVE_INTR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01346"/>01346 
<anchor xml:id="__i_r_timer_8hpp_source_1l01347"/>01347 <emphasis role="preprocessor">#&#32;&#32;ifdef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01348"/>01348 <emphasis role="preprocessor">#undef&#32;ISR</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01349"/>01349 <emphasis role="preprocessor">#&#32;&#32;endif</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01350"/><link linkend="_group___timer_1ga301c12193509807588b4db8e1b4ad5e7">01350</link> <emphasis role="preprocessor">#define&#32;ISR()&#32;void&#32;notImplemented(void)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01351"/>01351 
<anchor xml:id="__i_r_timer_8hpp_source_1l01352"/><link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">01352</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga45d57d84d5fee327f67afde5f8649e6d">timerConfigForSend</link>(uint8_t&#32;aFrequencyKHz)&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01353"/>01353 &#32;&#32;&#32;&#32;(void)&#32;aFrequencyKHz;
<anchor xml:id="__i_r_timer_8hpp_source_1l01354"/>01354 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01355"/><link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">01355</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_group___timer_1ga8cca92581b5452eaac5b3075227c6c56">timerConfigForReceive</link>()&#32;{
<anchor xml:id="__i_r_timer_8hpp_source_1l01356"/>01356 }
<anchor xml:id="__i_r_timer_8hpp_source_1l01357"/>01357 <emphasis role="preprocessor">#endif&#32;</emphasis><emphasis role="comment">//&#32;defined(DOXYGEN&#32;/&#32;CPU_TYPES)</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01358"/>01358 
<anchor xml:id="__i_r_timer_8hpp_source_1l01361"/>01361 <emphasis role="preprocessor">#endif&#32;</emphasis><emphasis role="comment">//&#32;#ifndef&#32;IR_TIMER_HPP</emphasis>
<anchor xml:id="__i_r_timer_8hpp_source_1l01362"/>01362 <emphasis role="preprocessor">#pragma&#32;once</emphasis>
</programlisting></section>
